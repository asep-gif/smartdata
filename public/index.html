<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kagum Smartdata</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- 1. Simple Page Flip Library -->
    <script src="https://cdn.jsdelivr.net/npm/page-flip/dist/js/page-flip.browser.min.js"></script>
    
    <!-- 2. jsPDF Library for PDF generation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- 2.1. html2canvas Library for capturing HTML content -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- 2.2. PDF.js Library for PDF rendering (required by ebook.js) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

    <!-- 3. SheetJS (XLSX) Library for Excel handling -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- BARU: SortableJS untuk Drag and Drop -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

    <!-- BARU: FullCalendar.js untuk Kalender -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/trial-balance.css">

    <!-- Custom Styles for Slide Cards -->
    <style>
        .slide-card-modern {
            min-height: 120px; /* Menetapkan tinggi minimum untuk kartu slide */
        }
        /* BARU: Style untuk item yang sedang di-drag */
        .sortable-ghost {
            opacity: 0.4;
            background: #c7d2fe; /* Warna indigo-200 */
            border: 2px dashed #6366f1; /* Warna indigo-500 */
        }
        /* BARU: Style untuk tombol statistik aktif */
        .active-stat-toggle-btn {
            background-color: #4f46e5 !important; /* bg-indigo-600 */
            color: white !important;
        }
        .active-stat-toggle-btn:hover {
            background-color: #4338ca !important; /* hover:bg-indigo-700 */
            color: white !important;
        }
        .trial-balance-card-modern {
            min-height: 300px; /* Menetapkan tinggi minimum untuk kartu trial balance */
        }
        /* BARU: Style untuk FullCalendar */
        #calendar {
            min-height: 650px; /* Memberi tinggi minimum agar kalender terlihat baik */
        }
        /* Kustomisasi warna event FullCalendar */
        .fc-event {
            border-width: 1px !important;
        }
        /* BARU: Style untuk tombol filter kalender aktif */
        .active-filter-btn {
            background-color: #4f46e5 !important; /* bg-indigo-600 */
            color: white !important;
        }
        .active-filter-btn:hover {
            background-color: #4338ca !important; /* hover:bg-indigo-700 */
        }
        /* BARU: Style untuk tooltip FullCalendar */
        .fc-tooltip {
            position: absolute;
            z-index: 10001; /* Di atas segalanya, termasuk modal */
            background: rgba(30, 41, 59, 0.9); /* slate-800 dengan opacity */
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            max-width: 250px;
            pointer-events: none; /* Agar tidak mengganggu event mouse lain */
            white-space: normal;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            opacity: 0; /* Mulai transparan untuk animasi fade-in */
        }
        .fc-tooltip-title {
            font-weight: bold;
            margin-bottom: 4px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 4px;
        }
        .fade-in-fast { animation: fadeInFastAnimation 0.2s ease-out forwards; }
        @keyframes fadeInFastAnimation { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-100 text-slate-800 font-sans antialiased h-screen flex flex-col md:flex-row overflow-hidden sidebar-collapsed">

    <!-- SIDEBAR -->
    <aside class="bg-white text-slate-800 flex flex-col z-30 fixed md:relative inset-y-0 left-0 border-r border-slate-200 transition-all duration-300 -translate-x-full md:translate-x-0" id="sidebar">
        <div class="h-16 px-6 flex items-center border-b border-slate-200 flex-shrink-0 relative">
            <!-- Ikon Hotel (hanya terlihat saat sidebar diciutkan) -->
            <i class="fa-solid fa-hotel text-2xl text-blue-500 icon-collapsed transition-opacity duration-200"></i>
            <!-- Logo Penuh (terlihat saat sidebar normal, terpusat) -->
            <!-- Logo Penuh (terlihat saat sidebar normal) -->
            <img src="assets/logo/logo.png" alt="Kagum Smartdata Logo" class="h-9 w-auto nav-text transition-opacity duration-200 mx-auto">
        </div>
        <nav class="flex-1 overflow-y-auto py-4">
            <ul class="space-y-1">
                <li><button onclick="window.location.hash = '#dashboard'" class="w-full flex items-center gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors active-menu" id="nav-dashboard"><div class="relative flex items-center gap-4" data-tooltip="Dashboard"><i class="fa-solid fa-chart-pie w-6 text-center"></i> <span class="nav-text">Dashboard</span></div></button></li>
                <!-- Menu Achievement (Dropdown) -->
                <li id="nav-achievement-parent">
                    <button onclick="toggleSubmenu('achievement-submenu')" class="w-full flex items-center justify-between gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors">
                        <div class="relative flex items-center gap-4" data-tooltip="Achievement">
                            <i class="fa-solid fa-trophy w-6 text-center"></i>
                            <span class="nav-text">Achievement</span>
                        </div>
                        <i id="achievement-submenu-arrow" class="fa-solid fa-chevron-down nav-text text-xs transition-transform"></i>
                    </button>
                    <ul id="achievement-submenu" class="hidden pl-8 pr-2 py-1 space-y-1 bg-slate-50">
                        <li><button onclick="window.location.hash = '#slides-corporate'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-slides-corporate"><div class="relative flex items-center gap-4" data-tooltip="Slides Corporate"><i class="fa-solid fa-building-columns w-6 text-center"></i> <span class="nav-text">Slides Corporate</span></div></button></li>
                        <li><button onclick="window.location.hash = '#slides'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-slides"><div class="relative flex items-center gap-4" data-tooltip="Slides Hotel"><i class="fa-solid fa-person-chalkboard w-6 text-center"></i> <span class="nav-text">Slides Hotel</span></div></button></li>
                        <li><button onclick="window.location.hash = '#ebook'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-ebook"><div class="relative flex items-center gap-4" data-tooltip="Budget Ebook"><i class="fa-solid fa-book-open w-6 text-center"></i> <span class="nav-text">Budget Ebook</span></div></button></li>
                        <li><button onclick="window.location.hash = '#input-budget'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-input-budget"><div class="relative flex items-center gap-4" data-tooltip="Input Budget P&L"><i class="fa-solid fa-file-invoice-dollar w-6 text-center"></i> <span class="nav-text">Input Budget P&L</span></div></button></li>
                        <li><button onclick="window.location.hash = '#input-actual'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-input-actual"><div class="relative flex items-center gap-4" data-tooltip="Input Actual P&L"><i class="fa-solid fa-money-check-dollar w-6 text-center"></i> <span class="nav-text">Input Actual P&L</span></div></button></li>
                    </ul>
                </li>
                <!-- Menu Daily Income (Dropdown) -->
                <li id="nav-daily-income-parent">
                    <button onclick="toggleSubmenu('daily-income-submenu')" class="w-full flex items-center justify-between gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors">
                        <div class="relative flex items-center gap-4" data-tooltip="Daily Income">
                            <i class="fa-solid fa-calendar-day w-6 text-center"></i>
                            <span class="nav-text">Daily Income</span>
                        </div>
                        <i id="daily-income-submenu-arrow" class="fa-solid fa-chevron-down nav-text text-xs transition-transform"></i>
                    </button>
                    <ul id="daily-income-submenu" class="hidden pl-8 pr-2 py-1 space-y-1 bg-slate-50">
                        <li><button onclick="window.location.hash = '#daily-income-dashboard'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-daily-income-dashboard"><div class="relative flex items-center gap-4" data-tooltip="Dashboard"><i class="fa-solid fa-chart-line w-6 text-center"></i> <span class="nav-text">Dashboard</span></div></button></li>
                        <li><button onclick="window.location.hash = '#input-budget-dsr'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-input-budget-dsr"><div class="relative flex items-center gap-4" data-tooltip="Input Budget DSR"><i class="fa-solid fa-file-pen w-6 text-center"></i> <span class="nav-text">Input Budget DSR</span></div></button></li>
                        <li><button onclick="window.location.hash = '#input-actual-dsr'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-input-actual-dsr"><div class="relative flex items-center gap-4" data-tooltip="Input Actual DSR"><i class="fa-solid fa-file-invoice w-6 text-center"></i> <span class="nav-text">Input Actual DSR</span></div></button></li>
                        <li><button onclick="window.location.hash = '#input-room-production'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-input-room-production"><div class="relative flex items-center gap-4" data-tooltip="Input Room Production"><i class="fa-solid fa-person-shelter w-6 text-center"></i> <span class="nav-text">Input Room Production</span></div></button></li>
                        <li><button onclick="window.location.hash = '#input-hotel-competitor'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-input-hotel-competitor"><div class="relative flex items-center gap-4" data-tooltip="Input Hotel Competitor"><i class="fa-solid fa-hotel w-6 text-center"></i> <span class="nav-text">Input Hotel Competitor</span></div></button></li>
                    </ul>
                </li>
                <!-- Menu AR Aging (Dropdown) -->
                <li id="nav-input-ar-aging-parent">
                    <button onclick="toggleSubmenu('input-ar-aging-submenu')" class="w-full flex items-center justify-between gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors">
                        <div class="relative flex items-center gap-4" data-tooltip="AR Aging">
                            <i class="fa-solid fa-hourglass-half w-6 text-center"></i>
                            <span class="nav-text">AR Aging</span>
                        </div>
                        <i id="input-ar-aging-submenu-arrow" class="fa-solid fa-chevron-down nav-text text-xs transition-transform"></i>
                    </button>
                    <ul id="input-ar-aging-submenu" class="hidden pl-8 pr-2 py-1 space-y-1 bg-slate-50">
                        <li><button onclick="window.location.hash = '#input-ar-aging'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-input-ar-aging"><div class="relative flex items-center gap-4" data-tooltip="Input AR Aging"><i class="fa-solid fa-file-pen w-6 text-center"></i> <span class="nav-text">Input AR Aging</span></div></button></li>
                        <li><button onclick="window.location.hash = '#ar-summary'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-ar-summary"><div class="relative flex items-center gap-4" data-tooltip="AR Summary"><i class="fa-solid fa-file-invoice w-6 text-center"></i> <span class="nav-text">AR Summary</span></div></button></li>
                    </ul>
                </li>
                <!-- BARU: Menu Internal Audit (Dropdown) -->
                <li id="nav-internal-audit-parent">
                    <button onclick="toggleSubmenu('internal-audit-submenu')" class="w-full flex items-center justify-between gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors">
                        <div class="relative flex items-center gap-4" data-tooltip="Internal Audit">
                            <i class="fa-solid fa-balance-scale w-6 text-center"></i>
                            <span class="nav-text">Internal Audit</span>
                        </div>
                        <i id="internal-audit-submenu-arrow" class="fa-solid fa-chevron-down nav-text text-xs transition-transform"></i>
                    </button>
                    <ul id="internal-audit-submenu" class="hidden pl-8 pr-2 py-1 space-y-1 bg-slate-50">
                        <li><button onclick="window.location.hash = '#trial-balance'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-trial-balance"><div class="relative flex items-center gap-4" data-tooltip="Trial Balance"><i class="fa-solid fa-file-invoice-dollar w-6 text-center"></i> <span class="nav-text">Trial Balance</span></div></button></li>
                        <li><button onclick="window.location.hash = '#agenda-audit'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-agenda-audit"><div class="relative flex items-center gap-4" data-tooltip="Agenda Audit"><i class="fa-solid fa-calendar-check w-6 text-center"></i> <span class="nav-text">Agenda Audit</span></div></button></li>
                        <li><button onclick="window.location.hash = '#audit-calendar'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-audit-calendar"><div class="relative flex items-center gap-4" data-tooltip="Audit Calendar"><i class="fa-solid fa-calendar-week w-6 text-center"></i> <span class="nav-text">Calendar</span></div></button></li>
                    </ul>
                </li>
                <!-- Menu Inspection (Dropdown) -->
                <li id="nav-inspection-parent">
                    <button onclick="toggleSubmenu('inspection-submenu')" class="w-full flex items-center justify-between gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors">
                        <div class="relative flex items-center gap-4" data-tooltip="Inspection">
                            <i class="fa-solid fa-clipboard-check w-6 text-center"></i>
                            <span class="nav-text">Inspection</span>
                        </div>
                        <i id="inspection-submenu-arrow" class="fa-solid fa-chevron-down nav-text text-xs transition-transform"></i>
                    </button>
                    <ul id="inspection-submenu" class="hidden pl-8 pr-2 py-1 space-y-1 bg-slate-50">
                        <li><button onclick="window.location.hash = '#inspection-dashboard'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-inspection-dashboard"><div class="relative flex items-center gap-4" data-tooltip="Dashboard Inspection"><i class="fa-solid fa-gauge w-6 text-center"></i> <span class="nav-text">Dashboard Inspection</span></div></button></li>
                        <li><button onclick="window.location.hash = '#hotel-inspection'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-hotel-inspection"><div class="relative flex items-center gap-4" data-tooltip="Hotel Inspection"><i class="fa-solid fa-magnifying-glass-location w-6 text-center"></i> <span class="nav-text">Hotel Inspection</span></div></button></li>
                        <li><button onclick="window.location.hash = '#task-to-do'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-task-to-do"><div class="relative flex items-center gap-4" data-tooltip="Task to Do"><i class="fa-solid fa-list-check w-6 text-center"></i> <span class="nav-text">Task to Do</span></div></button></li>
                    </ul>
                </li>
                <!-- BARU: Menu Guest Review (Dropdown) -->
                <li id="nav-guest-review-parent">
                    <button onclick="toggleSubmenu('guest-review-submenu')" class="w-full flex items-center justify-between gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors">
                        <div class="relative flex items-center gap-4" data-tooltip="Guest Review">
                            <i class="fa-solid fa-comments w-6 text-center"></i>
                            <span class="nav-text">Guest Review</span>
                        </div>
                        <i id="guest-review-submenu-arrow" class="fa-solid fa-chevron-down nav-text text-xs transition-transform"></i>
                    </button>
                    <ul id="guest-review-submenu" class="hidden pl-8 pr-2 py-1 space-y-1 bg-slate-50">
                        <li><button onclick="window.location.hash = '#guest-review-dashboard'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-guest-review-dashboard"><div class="relative flex items-center gap-4" data-tooltip="Dashboard"><i class="fa-solid fa-chart-bar w-6 text-center"></i> <span class="nav-text">Dashboard</span></div></button></li>
                        <li><button onclick="window.location.hash = '#guest-review-settings'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-guest-review-settings"><div class="relative flex items-center gap-4" data-tooltip="Setting Form"><i class="fa-solid fa-cogs w-6 text-center"></i> <span class="nav-text">Setting Form</span></div></button></li>
                        <li><button onclick="window.location.hash = '#guest-review-replies'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-guest-review-replies"><div class="relative flex items-center gap-4" data-tooltip="Replies"><i class="fa-solid fa-reply-all w-6 text-center"></i> <span class="nav-text">Replies</span></div></button></li>
                        <li><button onclick="window.location.hash = '#guest-review-vouchers'" class="w-full flex items-center gap-4 px-4 py-2.5 hover:bg-slate-200/60 border-l-4 border-transparent hover:border-blue-400 transition-colors text-sm" id="nav-guest-review-vouchers"><div class="relative flex items-center gap-4" data-tooltip="Voucher Use"><i class="fa-solid fa-ticket w-6 text-center"></i> <span class="nav-text">Voucher Use</span></div></button></li>
                    </ul>
                </li>
                <li><button onclick="window.location.hash = '#reports'" class="w-full flex items-center gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors" id="nav-reports"><div class="relative flex items-center gap-4" data-tooltip="Reports"><i class="fa-solid fa-file-contract w-6 text-center"></i> <span class="nav-text">Reports</span></div></button></li>
                <li><button onclick="window.location.hash = '#settings'" class="w-full flex items-center gap-4 px-6 py-3 hover:bg-slate-100 border-l-4 border-transparent hover:border-blue-400 transition-colors" id="nav-settings"><div class="relative flex items-center gap-4" data-tooltip="Settings"><i class="fa-solid fa-gear w-6 text-center"></i> <span class="nav-text">Settings</span></div></button></li>
            </ul>
        </nav>
        <!-- Profile has been moved to the main header -->
        <!-- Logout Button -->
        <div class="mt-auto p-4 border-t border-slate-200" onclick="handleLogout()">
            <button class="w-full flex items-center gap-4 px-4 py-2 text-sm text-slate-600 hover:bg-red-50 hover:text-red-600 rounded-md transition-colors"><div class="relative flex items-center gap-4" data-tooltip="Logout"><i class="fa-solid fa-right-from-bracket w-6 text-center"></i><span class="nav-text">Logout</span></div></button>
        </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="flex-1 flex flex-col h-full relative overflow-hidden transition-all duration-300">
        <!-- Main Header (was Mobile Header) -->
        <header class="bg-white shadow-sm h-16 flex items-center justify-between px-4 md:px-8 z-10 border-b border-slate-200 flex-shrink-0">
            <div class="flex items-center gap-4">
                <!-- Hamburger Menu -->
                <button onclick="toggleSidebar()" class="text-slate-600 hover:text-blue-500 md:hidden"><i class="fa-solid fa-bars text-xl"></i></button>
                <button onclick="toggleSidebar()" class="text-slate-600 hover:text-blue-500 hidden md:block"><i class="fa-solid fa-bars text-xl"></i></button>
                <div class="flex flex-col md:flex-row md:items-center md:gap-4">
                    <div id="header-title" class="font-bold text-base md:text-lg leading-tight">Dashboard Keuangan</div>
                    <div id="current-date" class="text-xs md:text-sm text-slate-500"></div>
                </div>
            </div>
            <!-- Profile Section -->
            <div id="profile-button" class="flex items-center gap-3 cursor-pointer">
                <img src="https://ui-avatars.com/api/?name=Admin&background=random" class="w-9 h-9 rounded-full profile-avatar">
                <div class="text-sm hidden md:block">
                    <p class="font-semibold profile-name">Administrator</p>
                    <p class="text-slate-500 text-xs profile-email">admin@hotel.com</p>
                </div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-4 md:p-8 bg-slate-50" id="main-scroll">
            
            <!-- 1. DASHBOARD -->
            <section id="page-dashboard" class="page-content-wrapper block fade-in">
                <!-- Filter Bar -->
                <div class="flex items-center gap-4 mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                    <h4 class="font-bold text-slate-600 flex-shrink-0">Filter Data:</h4>
                    <!-- Year Filter -->
                    <div class="flex-grow md:flex-grow-0">
                        <label for="dashboard-year-filter" class="sr-only">Tahun</label>
                        <select id="dashboard-year-filter" class="form-input w-full">
                            <!-- Opsi tahun akan diisi oleh JavaScript -->
                        </select>
                    </div>
                    <!-- Month Filter -->
                    <div class="flex-grow md:flex-grow-0">
                        <label for="dashboard-month-filter" class="sr-only">Bulan</label>
                        <select id="dashboard-month-filter" class="form-input w-full">
                            <!-- Opsi bulan akan diisi oleh JavaScript -->
                        </select>
                    </div>
                    <!-- Brand Filter -->
                    <div class="flex-grow md:flex-grow-0">
                        <label for="inspection-dashboard-brand-filter" class="sr-only">Brand</label>
                        <select id="inspection-dashboard-brand-filter" class="form-input w-full">
                            <!-- Opsi akan diisi oleh JavaScript -->
                        </select>
                    </div>
                    <!-- Hotel Checklist Filter -->
                    <div class="relative flex-grow md:flex-grow-0" id="dashboard-hotel-filter-container">
                        <button id="dashboard-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                            <span id="dashboard-hotel-filter-label" class="truncate pr-2">-- Pilih Hotel --</span>
                            <i class="fa-solid fa-chevron-down text-slate-400"></i>
                        </button>
                        <div id="dashboard-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full md:w-72 bg-white rounded-md shadow-lg border border-slate-200 max-h-80 overflow-y-auto right-0 md:right-auto">
                            <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                <input type="text" id="dashboard-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                <div class="flex justify-between items-center gap-4">
                                    <label class="flex items-center space-x-2 cursor-pointer flex-shrink-0">
                                        <input type="checkbox" id="dashboard-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                        <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                    </label>
                                    <button id="dashboard-hotel-filter-apply" class="flex-grow bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 px-3 rounded-md transition">Terapkan Filter</button>
                                </div>
                            </div>
                            <div id="dashboard-hotel-checklist-container" class="p-2 space-y-2">
                                <!-- Checklist hotel akan diisi oleh JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>
                <!-- BARU: Tombol Pindah Tampilan Statistik -->
                <div class="mb-4 flex justify-start">
                    <div id="stats-toggle-buttons" class="inline-flex rounded-md shadow-sm" role="group">
                        <button type="button" data-type="revenue" class="stat-toggle-btn active-stat-toggle-btn rounded-l-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 focus:z-10 focus:border-blue-500 focus:ring-2 focus:ring-blue-500">
                            Revenue
                        </button>
                        <button type="button" data-type="expenses" class="stat-toggle-btn border-y border-r border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 focus:z-10 focus:border-blue-500 focus:ring-2 focus:ring-blue-500">
                            Expenses
                        </button>
                        <button type="button" data-type="gop" class="stat-toggle-btn rounded-r-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 focus:z-10 focus:border-blue-500 focus:ring-2 focus:ring-blue-500">
                            GOP
                        </button>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 md:grid-cols-6 gap-4 mb-8">
                    <!-- BARU: Kartu Occupancy -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                        <p class="text-xs text-slate-500 font-bold uppercase truncate">OCCUPANCY</p>
                        <div class="flex justify-between items-baseline mt-1">
                            <h3 id="stats-occupancy-actual" class="text-xl font-bold text-slate-800">...</h3>
                            <span id="stats-occupancy-variance" class="text-xs font-semibold text-slate-500">...</span>
                        </div>
                        <div class="mt-1 text-xs text-slate-400 truncate">
                            Budget: <span id="stats-occupancy-budget">...</span>
                        </div>
                    </div>
                    <!-- BARU: Kartu ARR -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                        <p class="text-xs text-slate-500 font-bold uppercase truncate">AVG. ROOM RATE</p>
                        <div class="flex justify-between items-baseline mt-1">
                            <h3 id="stats-arr-actual" class="text-xl font-bold text-slate-800">...</h3>
                            <span id="stats-arr-variance" class="text-xs font-semibold text-slate-500">...</span>
                        </div>
                        <div class="mt-1 text-xs text-slate-400 truncate">
                            Budget: <span id="stats-arr-budget">...</span>
                        </div>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                        <p id="stats-budget-label" class="text-xs text-slate-500 font-bold uppercase">Total Budget Revenue</p>
                        <h3 id="stats-total-budget" class="text-xl font-bold mt-1 text-slate-800">...</h3>
                        <div id="stats-budget-year-label" class="mt-2 text-green-600 text-xs">Data Tahun Berjalan</div>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                        <p id="stats-actual-label" class="text-xs text-slate-500 font-bold uppercase">Total Actual Revenue</p>
                        <h3 id="stats-total-actual" class="text-xl font-bold mt-1 text-slate-800">...</h3>
                        <div id="stats-actual-year-label" class="mt-2 text-blue-600 text-xs">Realisasi Tahun Berjalan</div>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                        <p id="stats-variance-label" class="text-xs text-slate-500 font-bold uppercase">Selisih Budget Revenue</p>
                        <h3 id="stats-remaining-budget" class="text-xl font-bold mt-1 text-slate-800">...</h3>
                        <div class="mt-2 text-orange-500 text-xs">Actual vs Budget</div>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                        <p class="text-xs text-slate-500 font-bold uppercase">Cabang</p>
                        <h3 id="stats-hotel-count" class="text-xl font-bold mt-1 text-slate-800">...</h3>
                        <div class="mt-2 text-purple-600 text-xs">Active</div>
                    </div>
                </div>
                <!-- Charts -->
                <div id="dashboard-charts-grid" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col chart-card" data-id="gop-chart">
                        <div class="flex justify-between items-start">
                            <h4 class="font-bold mb-4">Realisasi Bulanan GOP</h4>
                            <i class="fa-solid fa-grip-vertical text-slate-300 cursor-move drag-handle"></i>
                        </div>
                        <div class="relative flex-1">
                            <canvas id="gopChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col chart-card" data-id="realization-chart">
                        <div class="flex justify-between items-start">
                            <h4 class="font-bold mb-4">Realisasi Bulanan Revenue</h4>
                            <i class="fa-solid fa-grip-vertical text-slate-300 cursor-move drag-handle"></i>
                        </div>
                        <div class="relative flex-1">
                            <canvas id="realizationChart"></canvas>
                        </div>
                    </div>
                    <!-- BARU: Grafik Perbandingan Occupancy & ARR -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col chart-card lg:col-span-2" data-id="occ-arr-chart">
                        <div class="flex justify-between items-start">
                            <h4 class="font-bold mb-4">Perbandingan Bulanan Occupancy & ARR</h4>
                            <i class="fa-solid fa-grip-vertical text-slate-300 cursor-move drag-handle"></i>
                        </div>
                        <div class="relative flex-1">
                            <canvas id="occupancyArrChart"></canvas>
                        </div>
                    </div>
                    <!-- Grafik Perbandingan Rasio -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col chart-card" data-id="ratio-chart">
                        <div class="flex justify-between items-start">
                            <h4 class="font-bold mb-4">Perbandingan Rasio Kunci (Actual vs. Budget)</h4>
                            <i class="fa-solid fa-grip-vertical text-slate-300 cursor-move drag-handle"></i>
                        </div>
                        <div class="relative flex-1">
                            <canvas id="ratioComparisonChart"></canvas>
                        </div>
                    </div>
                    <!-- Grafik Baru: Hotel Achievement Ratio -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex flex-col chart-card" data-id="achievement-chart">
                        <div class="flex justify-between items-start">
                             <h4 class="font-bold mb-4">Hotel Achievement Ratio (Actual vs Budget Revenue)</h4>
                             <i class="fa-solid fa-grip-vertical text-slate-300 cursor-move drag-handle"></i>
                        </div>
                        <div id="hotelAchievementChartContainer">
                            <canvas id="hotelAchievementChart"></canvas>
                        </div>
                    </div>
                    <!-- BARU: Room Production Charts Container (Span 2 columns) -->
                    <div class="lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6 chart-card" data-id="room-production-charts">
                        <!-- Grafik Pie Room Production by Segment -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                            <div class="flex justify-between items-start">
                                <h4 class="font-bold mb-4">Room Production by Market Segment</h4>
                                 <i class="fa-solid fa-grip-vertical text-slate-300 cursor-move drag-handle"></i>
                            </div>
                            <div class="relative flex-1"><canvas id="roomProductionSegmentChart"></canvas></div>
                        </div>
                        <!-- Grafik Batang ARR by Market Segment -->
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                            <div class="flex items-center justify-between mb-4">
                                <h4 id="arr-chart-title" class="font-bold">ARR Room Production by Market Segment</h4>
                                <button id="reset-arr-chart-btn" class="hidden text-xs bg-slate-100 hover:bg-slate-200 text-slate-600 font-semibold py-1 px-3 rounded-md transition">
                                    <i class="fa-solid fa-arrow-left mr-1"></i> Kembali
                                </button>
                            </div>
                            <div class="relative flex-1">
                                <canvas id="roomProductionArrChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- BARU: Tabel Ringkasan Performa P&L Hotel -->
                <div class="mt-6 bg-white p-6 rounded-xl shadow-sm border border-slate-100" id="pl-summary-table-card">
                    <h4 class="font-bold mb-4">Ringkasan Performa Hotel (P&L)</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-500" id="pl-summary-table">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th rowspan="2" class="px-4 py-3 border-b border-slate-200 align-bottom sticky left-0 bg-slate-50">Nama Hotel</th>
                                    <th colspan="6" class="px-4 py-3 text-center border-b border-l border-slate-200">Budget</th>
                                    <th colspan="6" class="px-4 py-3 text-center border-b border-l border-slate-200">Actual</th>
                                    <th colspan="6" class="px-4 py-3 text-center border-b border-l border-slate-200">Variance</th>
                                </tr>
                                <tr class="text-center">
                                    <!-- Budget -->
                                    <th class="px-3 py-2 font-medium border-l border-slate-200">Occ %</th>
                                    <th class="px-3 py-2 font-medium">ARR</th>
                                    <th class="px-3 py-2 font-medium">Total Revenue</th>
                                    <th class="px-3 py-2 font-medium">Total Expenses</th>
                                    <th class="px-3 py-2 font-medium">GOP</th>
                                    <th class="px-3 py-2 font-medium">% GOP</th>
                                    <!-- Actual -->
                                    <th class="px-3 py-2 font-medium border-l border-slate-200">Occ %</th>
                                    <th class="px-3 py-2 font-medium">ARR</th>
                                    <th class="px-3 py-2 font-medium">Total Revenue</th>
                                    <th class="px-3 py-2 font-medium">Total Expenses</th>
                                    <th class="px-3 py-2 font-medium">GOP</th>
                                    <th class="px-3 py-2 font-medium">% GOP</th>
                                    <!-- Variance -->
                                    <th class="px-3 py-2 font-medium border-l border-slate-200">Occ %</th>
                                    <th class="px-3 py-2 font-medium">ARR</th>
                                    <th class="px-3 py-2 font-medium">Total Revenue</th>
                                    <th class="px-3 py-2 font-medium">Total Expenses</th>
                                    <th class="px-3 py-2 font-medium">GOP</th>
                                    <th class="px-3 py-2 font-medium">% GOP</th>
                                </tr>
                            </thead>
                            <tbody id="pl-summary-table-body">
                                <!-- Data akan diisi oleh JavaScript -->
                                <tr><td colspan="19" class="p-8 text-center text-slate-500">
                                    <i class="fa-solid fa-circle-notch fa-spin text-2xl"></i><p class="mt-2">Memuat data ringkasan...</p>
                                </td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- 2. EBOOK LIBRARY -->
            <section id="page-ebook" class="page-content-wrapper hidden">
                <div class="mb-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div class="flex items-center gap-4 w-full md:w-auto">
                        <!-- Search Input -->
                        <div class="relative flex-grow md:flex-grow-0">
                            <input type="text" id="search-book-input" onkeyup="searchBooks()" placeholder="Cari buku..." class="form-input w-full pl-10 py-2">
                            <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
                        </div>
                        <!-- BARU: Filter Hotel untuk E-Book -->
                        <div class="flex-grow md:flex-grow-0">
                            <select id="ebook-hotel-filter" class="form-input w-full">
                                <!-- Opsi akan diisi oleh JavaScript -->
                            </select>
                        </div>
                        <!-- Shortcut Upload Button -->
                        <button onclick="openUploadModal()" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-md shadow transition flex-shrink-0"><i class="fa-solid fa-plus mr-1"></i> Tambah</button>
                    </div>
                </div>

                <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-5 xl:grid-cols-6 gap-6" id="library-grid">
                    <!-- Buku yang di-upload akan muncul di sini -->
                </div>

                <!-- 3D FLIPBOOK MODAL -->
                <div id="book-modal" class="fixed inset-0 z-50 bg-slate-900/95 hidden flex-col items-center justify-center backdrop-blur-sm">
                    <!-- Toolbar -->
                    <div class="absolute top-0 w-full p-4 flex justify-between items-center text-white z-50 bg-gradient-to-b from-black/50 to-transparent">
                        <h3 id="modal-title" class="text-lg font-bold drop-shadow-md">Judul Buku</h3>
                        <div class="flex gap-4">
                            <!-- Reset Zoom Button -->
                             <button onclick="resetZoom()" class="bg-white/10 hover:bg-white/20 px-3 py-2 rounded-lg text-xs backdrop-blur transition mr-2" title="Reset Zoom">
                                <i class="fa-solid fa-compress"></i> Reset
                            </button>
                            <button onclick="closeBook()" class="bg-white/10 hover:bg-red-600 px-4 py-2 rounded-lg text-sm backdrop-blur transition"><i class="fa-solid fa-xmark"></i> Tutup</button>
                        </div>
                    </div>

                    <!-- Flipbook Container Wrapper (ADDED ID HERE) -->
                    <!-- Flex center + Padding Top/Bottom (pt-20 pb-24) to create Safe Area -->
                    <div id="book-wrapper" class="w-full h-full flex items-center justify-center overflow-hidden pt-20 pb-24">
                        <div class="book-container shadow-2xl" id="book-container">
                            <!-- Pages injected by JS -->
                        </div>
                    </div>

                    <!-- Loading Indicator inside modal -->
                    <div id="pdf-loading" class="hidden absolute flex-col items-center text-white z-40">
                        <i class="fa-solid fa-circle-notch fa-spin text-4xl mb-3 text-blue-400"></i>
                        <p>Menggabungkan & Merender Halaman PDF...</p>
                    </div>

                    <!-- Controls -->
                    <div class="absolute bottom-6 flex gap-4 z-50 items-center">
                        <button onclick="bookPrev()" class="bg-white/10 hover:bg-blue-600 text-white w-12 h-12 rounded-full flex items-center justify-center backdrop-blur transition shadow-lg"><i class="fa-solid fa-chevron-left"></i></button>
                        
                        <!-- Zoom Controls -->
                        <div class="flex bg-black/40 backdrop-blur rounded-full px-4 py-2 gap-4 items-center shadow-lg border border-white/10">
                            <button onclick="zoomOut()" class="text-white hover:text-blue-400 transition" title="Zoom Out"><i class="fa-solid fa-magnifying-glass-minus"></i></button>
                            <span id="zoom-level" class="text-white text-xs font-mono w-10 text-center">100%</span>
                            <button onclick="zoomIn()" class="text-white hover:text-blue-400 transition" title="Zoom In"><i class="fa-solid fa-magnifying-glass-plus"></i></button>
                        </div>

                        <button onclick="bookNext()" class="bg-white/10 hover:bg-blue-600 text-white w-12 h-12 rounded-full flex items-center justify-center backdrop-blur transition shadow-lg"><i class="fa-solid fa-chevron-right"></i></button>
                    </div>
                </div>
            </section>

            <!-- 10. SLIDES PAGE -->
            <section id="page-slides" class="page-content-wrapper hidden fade-in">
                <!-- Header dengan Filter dan Tombol -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 mb-6">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                        <!-- Judul "Google Slides Presentation" telah dihapus sesuai permintaan -->
                        <!-- Tombol Tambah Slide dipindahkan menjadi FAB -->
                    </div>

                <!-- Konten Grid Slide (Diperbarui untuk kartu yang lebih besar) -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="slides-grid">
                    <!-- Slide thumbnails will be loaded here -->
                </div>

                <div id="no-slides-message" class="text-center text-slate-500 py-10 hidden">
                    <i class="fa-solid fa-folder-open text-5xl mb-3"></i>
                    <p class="text-lg">Belum ada slide tersedia untuk hotel ini.</p>
                    <p class="text-sm mt-2">Tambahkan slide baru dengan tombol "Tambah Slide".</p>
                </div>

                <!-- BARU: Floating Action Button (FAB) untuk Tambah Slide -->
                <div class="relative">
                    <button onclick="openAddSlideModal('hotel')" title="Tambah Slide Hotel Baru" class="fixed bottom-10 right-10 z-20 w-14 h-14 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center shadow-lg transition-transform hover:scale-110">
                        <i class="fa-solid fa-plus text-xl"></i>
                    </button>
                </div>
            </section>

            <!-- BARU: 10.1 SLIDES CORPORATE PAGE -->
            <section id="page-slides-corporate" class="page-content-wrapper hidden fade-in">
                <!-- Header dengan Filter dan Tombol -->
                <div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 mb-6">
                    <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                        <!-- Judul halaman ini akan diatur oleh JavaScript -->
                    </div>

                <!-- Konten Grid Slide -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="slides-corporate-grid">
                    <!-- Slide thumbnails will be loaded here -->
                </div>

                <div id="no-slides-corporate-message" class="text-center text-slate-500 py-10 hidden">
                    <i class="fa-solid fa-folder-open text-5xl mb-3"></i>
                    <p class="text-lg">Belum ada slide corporate tersedia.</p>
                    <p class="text-sm mt-2">Tambahkan slide baru dengan tombol "Tambah Slide".</p>
                </div>

                <!-- FAB untuk Tambah Slide (akan menggunakan modal yang sama) -->
                <button onclick="openAddSlideModal('corporate')" title="Tambah Slide Corporate Baru" class="fixed bottom-10 right-10 z-20 w-14 h-14 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center shadow-lg transition-transform hover:scale-110">
                    <i class="fa-solid fa-plus text-xl"></i>
                </button>
            </section>

			<!-- 11. TRIAL BALANCE PAGE -->
			<section id="page-trial-balance" class="page-content-wrapper hidden fade-in">
				<!-- Header dengan Filter dan Tombol -->
				<div class="bg-white p-4 rounded-xl shadow-sm border border-slate-100 mb-6">
					<div class="flex flex-col md:flex-row justify-between items-center gap-4">
						<h2 class="text-xl font-bold text-slate-700">Trial Balance - Google Sheets</h2>
						<div class="flex items-center gap-4">
							<label for="trial-balance-status-filter" class="text-sm font-medium text-slate-600 flex-shrink-0">Filter Status:</label>
							<select id="trial-balance-status-filter" class="form-input w-full md:w-48">
								<option value="all">Semua</option>
								<option value="not_audited">Belum Diaudit</option>
								<option value="in_audit">Sedang Diaudit</option>
								<option value="closed">Sudah Closing</option>
							</select>
						</div>
					</div>
				</div>

				<!-- Konten Grid Slide (Diperbarui untuk kartu yang lebih besar) -->
				<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6" id="trial-balance-grid">
					<!-- Slide thumbnails will be loaded here -->
				</div>

				<div id="no-trial-balance-message" class="text-center text-slate-500 py-10 hidden">
					<i class="fa-solid fa-folder-open text-5xl mb-3"></i>
					<p class="text-lg">Belum ada trial balance tersedia.</p>
					<p class="text-sm mt-2">Tambahkan trial balance baru dengan tombol "Tambah".</p>
				</div>

				<!-- BARU: Floating Action Button (FAB) untuk Tambah Slide -->
				<div class="relative">
					<button onclick="openAddTrialBalanceModal()" title="Tambah Trial Balance Baru" class="fixed bottom-10 right-10 z-20 w-14 h-14 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center shadow-lg transition-transform hover:scale-110">
						<i class="fa-solid fa-plus text-xl"></i>
					</button>
				</div>
			</section>

            <!-- 3. SETTINGS -->
            <section id="page-settings" class="page-content-wrapper hidden fade-in">
                <!-- Grid untuk konten pengaturan utama -->
                <div id="settings-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

                    <!-- Kartu Kelola Pengguna (sekarang menjadi tombol) -->
                    <button onclick="window.location.hash = '#settings/users'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-users-cog text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Kelola Pengguna</h3>
                                <p class="text-sm text-slate-500">Lihat, tambah, dan atur pengguna.</p>
                            </div>
                        </div>
                    </button>

                    <!-- Kartu Kelola Hotel -->
                    <button onclick="window.location.hash = '#settings/hotels'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-green-100 text-green-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-building text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Kelola Hotel</h3>
                                <p class="text-sm text-slate-500">Atur daftar hotel dan brand.</p>
                            </div>
                        </div>
                    </button>

                    <!-- BARU: Kartu Opening Balance DSR -->
                    <button onclick="window.location.hash = '#settings/opening-balance-dsr'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-book-bookmark text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Opening Balance DSR</h3>
                                <p class="text-sm text-slate-500">Atur saldo awal untuk laporan DSR.</p>
                            </div>
                        </div>
                    </button>

                    <!-- BARU: Kartu Kelola Tipe Inspeksi -->
                    <button onclick="window.location.hash = '#settings/inspection-types'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-tags text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Kelola Tipe Inspeksi</h3>
                                <p class="text-sm text-slate-500">Atur template dan item untuk inspeksi.</p>
                            </div>
                        </div>
                    </button>

                    <!-- BARU: Kartu Kelola Role & Hak Akses -->
                    <button onclick="window.location.hash = '#settings/roles'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-rose-100 text-rose-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-user-shield text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Kelola Role & Hak Akses</h3>
                                <p class="text-sm text-slate-500">Atur peran dan izin akses pengguna.</p>
                            </div>
                        </div>
                    </button>

                    <!-- BARU: Kartu Kelola Checklist Audit -->
                    <button onclick="window.location.hash = '#settings/audit-checklists'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-teal-100 text-teal-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-tasks text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Kelola Checklist Audit</h3>
                                <p class="text-sm text-slate-500">Atur item untuk checklist kunjungan audit.</p>
                            </div>
                        </div>
                    </button>

                    <!-- BARU: Kartu Kelola Hotel Competitor -->
                    <button onclick="window.location.hash = '#settings/competitors'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-indigo-100 text-indigo-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-hotel text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Kelola Hotel Competitor</h3>
                                <p class="text-sm text-slate-500">Tentukan daftar kompetitor untuk setiap hotel.</p>
                            </div>
                        </div>
                    </button>

                    <!-- Kartu pengaturan lainnya bisa ditambahkan di sini -->
                </div>

                <!-- Bagian Manajemen Pengguna (awalnya tersembunyi) -->
                <div id="user-management-section" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold">Daftar Pengguna</h3>
                        <button onclick="openAddUserModal()" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                            <i class="fa-solid fa-plus mr-1"></i> Tambah Pengguna
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3">Nama Lengkap</th>
                                    <th scope="col" class="px-6 py-3">Email</th>
                                    <th scope="col" class="px-6 py-3">Password</th>
                                    <th scope="col" class="px-6 py-3">Role</th>
                                    <th scope="col" class="px-6 py-3 text-center">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="user-table-body">
                                <!-- Data pengguna akan dimuat di sini oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- BARU: Bagian Opening Balance DSR (awalnya tersembunyi) -->
                <div id="opening-balance-dsr-section" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <div class="flex justify-between items-center mb-4">
                        <div>
                            <h3 class="text-xl font-bold">Opening Balance DSR Actual</h3>
                            <p class="text-sm text-slate-500">Saldo awal ini akan menjadi acuan perhitungan Balance pada tabel Actual DSR.</p>
                        </div>
                        <button onclick="window.location.hash = '#settings'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                            <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                        </button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3">Nama Hotel</th>
                                    <th scope="col" class="px-6 py-3">Tanggal Efektif Saldo Awal</th>
                                    <th scope="col" class="px-6 py-3 text-right">Nilai Saldo Awal</th>
                                    <th scope="col" class="px-6 py-3 text-center">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="opening-balance-table-body"></tbody>
                        </table>
                    </div>
            </div>

            <!-- BARU: Bagian Kelola Hotel Competitor (awalnya tersembunyi) -->
            <div id="competitor-settings-section" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <div class="flex justify-between items-center mb-6 pb-4 border-b border-slate-200">
                    <div>
                        <h3 class="text-xl font-bold">Kelola Daftar Kompetitor</h3>
                        <p class="text-sm text-slate-500">Atur siapa saja kompetitor untuk hotel Anda.</p>
                    </div>
                    <button onclick="window.location.hash = '#settings'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                        <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                    </button>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Kolom Kiri: Pilih Hotel & Tambah Kompetitor -->
                    <div class="lg:col-span-1 space-y-6">
                        <div>
                            <label for="comp-setting-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Pilih Hotel (Subject)</label>
                            <select id="comp-setting-hotel-select" class="form-input w-full"></select>
                        </div>

                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <h4 class="font-semibold text-slate-700 mb-3">Tambah Kompetitor Baru</h4>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Pilih dari Daftar Hotel Sistem</label>
                                    <select id="comp-setting-existing-hotel" class="form-input w-full text-sm mb-2"></select>
                                    <button id="add-existing-comp-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 rounded transition">Tambah dari Daftar</button>
                                </div>
                                <div class="relative flex py-2 items-center"><div class="flex-grow border-t border-slate-300"></div><span class="flex-shrink-0 mx-2 text-slate-400 text-xs">ATAU</span><div class="flex-grow border-t border-slate-300"></div></div>
                                <div>
                                    <label class="block text-xs font-medium text-slate-600 mb-1">Input Manual (Hotel Luar)</label>
                                    <input type="text" id="comp-setting-manual-name" class="form-input w-full text-sm mb-2" placeholder="Nama Hotel Kompetitor">
                                    <input type="number" id="comp-setting-manual-rooms" class="form-input w-full text-sm mb-2" placeholder="Jumlah Kamar">
                                    <button id="add-manual-comp-btn" class="w-full bg-green-600 hover:bg-green-700 text-white text-xs font-bold py-2 rounded transition">Tambah Manual</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Kolom Kanan: Daftar Kompetitor -->
                    <div class="lg:col-span-2">
                        <h4 class="font-semibold text-slate-700 mb-3">Daftar Kompetitor Aktif</h4>
                        <div class="overflow-hidden rounded-lg border border-slate-200">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3">Nama Kompetitor</th>
                                        <th scope="col" class="px-6 py-3">Jumlah Kamar</th>
                                        <th scope="col" class="px-6 py-3 text-center">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="competitor-list-body">
                                    <tr><td colspan="2" class="p-4 text-center text-slate-400">Silakan pilih hotel terlebih dahulu.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- BARU: Bagian Kelola Role & Hak Akses (awalnya tersembunyi) -->
            <div id="role-management-section" class="hidden">
                <div id="role-management-container"></div>
            </div>
            </section>

            <!-- 4. INPUT BUDGET -->
            <section id="page-input-budget" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Selection Header -->
                    <div id="budget-selection-header" class="mb-6 pb-6 border-b border-slate-200">
                        <h3 class="text-xl font-bold mb-4">Pengaturan Budget P&L</h3>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                            <div>
                                <label for="budget-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="budget-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="budget-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <select id="budget-hotel-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <button id="export-template-btn" class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-file-excel mr-1"></i> Export Template
                                </button>
                            </div>
                            <div>
                                <button id="load-budget-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-sync-alt mr-1"></i> Muat Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Budget Editor Container (hidden by default) -->
                    <div id="budget-editor-container" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Input Budget P&L Tahunan</h3>
                            <div class="flex items-center gap-2">
                                <input type="file" id="excel-upload-input" class="hidden" accept=".xlsx, .xls" onchange="handleExcelUpload(event)">
                                <button id="upload-excel-btn" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                                    <i class="fa-solid fa-file-upload mr-1"></i> Upload Excel
                                </button>
                                <button id="save-budget-btn" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                                    <i class="fa-solid fa-save mr-1"></i> Simpan Budget
                                </button>
                            </div>
                        </div>
                        <div class="overflow-auto max-h-[65vh]">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0 z-10">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 min-w-[200px] sticky left-0 bg-slate-50 z-10">DESCRIPTION</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">JANUARY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">FEBRUARY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">MARCH</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">APRIL</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">MAY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">JUNE</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">JULY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">AUGUST</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">SEPTEMBER</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">OCTOBER</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">NOVEMBER</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">DECEMBER</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right font-bold">YEAR TO DATE</th>
                                    </tr>
                                </thead>
                                <tbody id="budget-table-body">
                                    <!-- Data budget akan dimuat di sini oleh JavaScript -->
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">STATISTIC</td></tr>
                                    <tr data-id="stat_days"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">No. Of Days</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_room_available"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">No Of Room Available</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_occupied_rooms"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Occupied Rooms</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_occupancy_percent" data-formula="occupancy"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% Of Occupancy</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_guests"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Number of Guest</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_arr" data-formula="arr"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Average Room Rate in Rp.</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_revpar" data-formula="revpar"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">RevPAR in Rp.</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">REVENUE</td></tr>
                                    <tr data-id="rev_room"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Room Revenue</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="rev_fnb"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Food & Beverage Revenue</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="rev_others"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Others Revenue</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_revenue" data-formula="sum" data-sum-of="rev_room,rev_fnb,rev_others" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL REVENUE</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">COST OF SALES</td></tr>
                                    <tr data-id="cos_fnb"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Cost of Food & Beverage</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="cos_others"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Cost of Others</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_cos" data-formula="sum" data-sum-of="cos_fnb,cos_others" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL COST OF SALES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">OPERATING SALARY & WAGES</td></tr>
                                    <tr data-id="osaw_room"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Room Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="osaw_fnb"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Food & Beverage Salary & wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_osaw" data-formula="sum" data-sum-of="osaw_room,osaw_fnb" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL OPERATING SALARY & WAGES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">OPERATING OTHER EXPENSES</td></tr>
                                    <tr data-id="ooe_room"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Room Other Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ooe_fnb"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Food & Beverage Other Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_ooe" data-formula="sum" data-sum-of="ooe_room,ooe_fnb" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL OTHER EXPENSES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">OPERATING DEPARTMENT PROFIT</td></tr>
                                    <tr data-id="odp_room_goi" data-formula="calc"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Room Gross Operating Income</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="odp_fnb_goi" data-formula="calc"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Food & Beverage Gross Operating Income</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="odp_others_goi" data-formula="calc"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Others Gross Operating Income</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_odp" data-formula="sum" data-sum-of="odp_room_goi,odp_fnb_goi,odp_others_goi" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL OPERATING DEPT. PROFIT</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">UNDISTRIBUTED SALARY & WAGES</td></tr>
                                    <tr data-id="usaw_ag"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Administration & General Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="usaw_sm"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Sales & Marketing Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="usaw_pomec"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Pomec Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_usaw" data-formula="sum" data-sum-of="usaw_ag,usaw_sm,usaw_pomec" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL UNDISTRIBUTED SALARY & WAGES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">UNDISTRIBUTED OPERATING EXPENSES</td></tr>
                                    <tr data-id="uoe_ag"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Administration & General Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="uoe_sm"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Sales & Marketing Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="uoe_pomec"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Pomec Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="uoe_energy"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Energy Cost</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_uoe" data-formula="sum" data-sum-of="uoe_ag,uoe_sm,uoe_pomec,uoe_energy" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL UNDISTRIBUTED OPR. EXPENSES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_undistributed_exp" data-formula="sum" data-sum-of="total_usaw,total_uoe" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL UNDISTRIBUTED EXP.</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="mgt_fee" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">Management Fee</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="gop" data-formula="calc" class="bg-blue-100 font-bold text-blue-800"><td class="px-4 py-2 sticky left-0 bg-blue-100">GROSS OPERATING PROFIT</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="gop_ratio" data-formula="percent" class="bg-blue-100 font-bold text-blue-800"><td class="px-4 py-2 sticky left-0 bg-blue-100">% G.O.P Ratio</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">RATIO</td></tr>
                                    <tr data-id="ratio_salary_wages" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_energy" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% Energy Cost</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_room_goi" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% Room GoI</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_fnb_goi" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% F&B GoI</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_sm_exp" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% S&M Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_mfee" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% MFee</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 5. INPUT ACTUAL -->
            <section id="page-input-actual" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Selection Header -->
                    <div id="actual-selection-header" class="mb-6 pb-6 border-b border-slate-200">
                        <h3 class="text-xl font-bold mb-4">Pengaturan Actual P&L</h3>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                            <div>
                                <label for="actual-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="actual-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="actual-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <select id="actual-hotel-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <button id="export-actual-template-btn" class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-file-excel mr-1"></i> Export Template
                                </button>
                            </div>
                            <div>
                                <button id="load-actual-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-sync-alt mr-1"></i> Muat Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Actual Editor Container (hidden by default) -->
                    <div id="actual-editor-container" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Input Actual P&L Tahunan</h3>
                            <div class="flex items-center gap-2">
                                <input type="file" id="actual-excel-upload-input" class="hidden" accept=".xlsx, .xls" onchange="handleActualExcelUpload(event)">
                                <button id="upload-actual-excel-btn" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                                    <i class="fa-solid fa-file-upload mr-1"></i> Upload Excel
                                </button>
                                <button id="save-actual-btn" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                                    <i class="fa-solid fa-save mr-1"></i> Simpan Actual
                                </button>
                            </div>
                        </div>
                        <div class="overflow-auto max-h-[65vh]">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0 z-10">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 min-w-[200px] sticky left-0 bg-slate-50 z-10">DESCRIPTION</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">JANUARY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">FEBRUARY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">MARCH</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">APRIL</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">MAY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">JUNE</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">JULY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">AUGUST</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">SEPTEMBER</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">OCTOBER</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">NOVEMBER</th>
                                        <th scope="col" class="px-4 py-3 min-w-[120px] text-right">DECEMBER</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right font-bold">YEAR TO DATE</th>
                                    </tr>
                                </thead>
                                <tbody id="actual-table-body">
                                    <!-- Data actual akan dimuat di sini oleh JavaScript -->
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">STATISTIC</td></tr>
                                    <tr data-id="stat_days"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">No. Of Days</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_room_available"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">No Of Room Available</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_occupied_rooms"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Occupied Rooms</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_occupancy_percent" data-formula="occupancy"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% Of Occupancy</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_guests"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Number of Guest</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_arr" data-formula="arr"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Average Room Rate in Rp.</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="stat_revpar" data-formula="revpar"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">RevPAR in Rp.</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">REVENUE</td></tr>
                                    <tr data-id="rev_room"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Room Revenue</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="rev_fnb"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Food & Beverage Revenue</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="rev_others"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Others Revenue</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_revenue" data-formula="sum" data-sum-of="rev_room,rev_fnb,rev_others" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL REVENUE</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">COST OF SALES</td></tr>
                                    <tr data-id="cos_fnb"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Cost of Food & Beverage</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="cos_others"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Cost of Others</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_cos" data-formula="sum" data-sum-of="cos_fnb,cos_others" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL COST OF SALES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">OPERATING SALARY & WAGES</td></tr>
                                    <tr data-id="osaw_room"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Room Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="osaw_fnb"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Food & Beverage Salary & wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_osaw" data-formula="sum" data-sum-of="osaw_room,osaw_fnb" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL OPERATING SALARY & WAGES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">OPERATING OTHER EXPENSES</td></tr>
                                    <tr data-id="ooe_room"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Room Other Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ooe_fnb"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Food & Beverage Other Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_ooe" data-formula="sum" data-sum-of="ooe_room,ooe_fnb" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL OTHER EXPENSES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">OPERATING DEPARTMENT PROFIT</td></tr>
                                    <tr data-id="odp_room_goi" data-formula="calc"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Room Gross Operating Income</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="odp_fnb_goi" data-formula="calc"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Food & Beverage Gross Operating Income</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="odp_others_goi" data-formula="calc"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Others Gross Operating Income</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_odp" data-formula="sum" data-sum-of="odp_room_goi,odp_fnb_goi,odp_others_goi" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL OPERATING DEPT. PROFIT</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">UNDISTRIBUTED SALARY & WAGES</td></tr>
                                    <tr data-id="usaw_ag"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Administration & General Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="usaw_sm"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Sales & Marketing Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="usaw_pomec"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Pomec Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_usaw" data-formula="sum" data-sum-of="usaw_ag,usaw_sm,usaw_pomec" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL UNDISTRIBUTED SALARY & WAGES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">UNDISTRIBUTED OPERATING EXPENSES</td></tr>
                                    <tr data-id="uoe_ag"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Administration & General Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="uoe_sm"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Sales & Marketing Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="uoe_pomec"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Pomec Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="uoe_energy"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">Energy Cost</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_uoe" data-formula="sum" data-sum-of="uoe_ag,uoe_sm,uoe_pomec,uoe_energy" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL UNDISTRIBUTED OPR. EXPENSES</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="total_undistributed_exp" data-formula="sum" data-sum-of="total_usaw,total_uoe" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">TOTAL UNDISTRIBUTED EXP.</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="mgt_fee" class="bg-slate-50 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-50">Management Fee</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="gop" data-formula="calc" class="bg-blue-100 font-bold text-blue-800"><td class="px-4 py-2 sticky left-0 bg-blue-100">GROSS OPERATING PROFIT</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="gop_ratio" data-formula="percent" class="bg-blue-100 font-bold text-blue-800"><td class="px-4 py-2 sticky left-0 bg-blue-100">% G.O.P Ratio</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr class="bg-slate-100 font-bold"><td class="px-4 py-2 sticky left-0 bg-slate-100" colspan="14">RATIO</td></tr>
                                    <tr data-id="ratio_salary_wages" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% Salary & Wages</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_energy" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% Energy Cost</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_room_goi" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% Room GoI</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_fnb_goi" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% F&B GoI</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_sm_exp" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% S&M Expenses</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                    <tr data-id="ratio_mfee" data-formula="percent"><td class="px-4 py-2 pl-8 sticky left-0 bg-white">% MFee</td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right"></td><td class="px-4 py-2 text-right font-bold"></td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 6. INPUT BUDGET DSR -->
            <section id="page-input-budget-dsr" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Selection Header -->
                    <div id="budget-dsr-selection-header" class="mb-6 pb-6 border-b border-slate-200">
                        <h3 class="text-xl font-bold mb-4">Pengaturan Budget DSR</h3>
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-end">
                            <div>
                                <label for="budget-dsr-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="budget-dsr-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="budget-dsr-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan</label>
                                <select id="budget-dsr-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="budget-dsr-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <select id="budget-dsr-hotel-select" class="form-input w-full"></select>
                        </div>
                        <div>
                            <button id="export-budget-dsr-template-btn" class="w-full px-4 py-2 bg-teal-600 text-white rounded-lg shadow hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-opacity-50 transition-colors flex items-center justify-center">
                                <i class="fa-solid fa-file-excel mr-2"></i>Export Template
                            </button>
                            </div>
                            <div>
                                <button id="load-budget-dsr-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-sync-alt mr-1"></i> Muat Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Budget DSR Editor Container (hidden by default) -->
                    <div id="budget-dsr-editor-container" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Input Budget Harian</h3>
                            <div class="flex items-center gap-2">
                                <!-- Tombol Import dipindahkan ke sini -->
                                <input type="file" id="import-budget-dsr-input" class="hidden" accept=".xlsx, .xls">
                                <button id="import-budget-dsr-btn" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-md shadow transition flex items-center">
                                    <i class="fa-solid fa-file-import mr-2"></i>Import Excel
                                </button>
                                <!-- Tombol Simpan -->
                                <button id="save-budget-dsr-btn" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                                    <i class="fa-solid fa-save mr-1"></i> Simpan Budget DSR
                                </button>
                            </div>
                        </div>
                        <div class="overflow-auto max-h-[65vh]">
                            <table id="budget-dsr-table" class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0 z-10">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 min-w-[100px] sticky left-0 bg-slate-50 z-10">DATE</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room Available</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room OOO</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room Com & HU</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room Sold</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Number of Guest</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">%Occp R.Sold</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">ARR</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">RevPAR</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Lodging Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Others Room Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">Room Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Breakfast Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Restaurant Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room Service</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Banquet Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">F&B Others</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">F&B Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Others Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">Total Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Service</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Tax</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">Gross Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Shared Payable</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Deposit Reservation</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Cash FO</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Cash Outlet</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Bank Transfer</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">QRIS</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Credit Debit Card</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">City Ledger</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">Total Settlement</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">GAB</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">BALANCE</th>
                                    </tr>
                                </thead>
                                <tbody id="budget-dsr-table-body">
                                    <!-- Data budget DSR akan dimuat di sini oleh JavaScript -->
                                </tbody>
                                <tfoot id="budget-dsr-table-foot" class="bg-slate-100 font-bold sticky bottom-0">
                                    <!-- Baris Total MTD akan digenerate oleh JavaScript di sini -->
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 7. INPUT ACTUAL DSR -->
            <section id="page-input-actual-dsr" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Selection Header -->
                    <div id="actual-dsr-selection-header" class="mb-6 pb-6 border-b border-slate-200">
                        <h3 class="text-xl font-bold mb-4">Pengaturan Actual DSR</h3>
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-end">
                            <div>
                                <label for="actual-dsr-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="actual-dsr-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="actual-dsr-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan</label>
                                <select id="actual-dsr-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="actual-dsr-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <select id="actual-dsr-hotel-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <button id="export-actual-dsr-template-btn" class="w-full px-4 py-2 bg-teal-600 text-white rounded-lg shadow hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-opacity-50 transition-colors flex items-center justify-center">
                                    <i class="fa-solid fa-file-excel mr-2"></i>Export Template
                                </button>
                            </div>
                            <div>
                                <button id="load-actual-dsr-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-sync-alt mr-1"></i> Muat Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Actual DSR Editor Container (hidden by default) -->
                    <div id="actual-dsr-editor-container" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Input Actual Harian</h3>
                            <div class="flex items-center gap-2">
                                <!-- Tombol Import dipindahkan ke sini -->
                                <input type="file" id="import-actual-dsr-input" class="hidden" accept=".xlsx, .xls">
                                <button id="import-actual-dsr-btn" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-md shadow transition flex items-center">
                                    <i class="fa-solid fa-file-import mr-2"></i>Import Excel
                                </button>
                                <!-- Tombol Simpan -->
                                <button id="save-actual-dsr-btn" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                                    <i class="fa-solid fa-save mr-1"></i> Simpan Actual DSR
                                </button>
                            </div>
                        </div>
                        <div class="overflow-auto max-h-[65vh]">
                            <table id="actual-dsr-table" class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0 z-10">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 min-w-[100px] sticky left-0 bg-slate-50 z-10">DATE</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room Available</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room OOO</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room Com & HU</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room Sold</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Number of Guest</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">%Occp R.Sold</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">ARR</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">RevPAR</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Lodging Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Others Room Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">Room Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Breakfast Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Restaurant Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Room Service</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Banquet Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">F&B Others</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">F&B Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Others Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">Total Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Service</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Tax</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">Gross Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Shared Payable</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Deposit Reservation</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Cash FO</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Cash Outlet</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Bank Transfer</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">QRIS</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">Credit Debit Card</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right">City Ledger</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">Total Settlement</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">GAB</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px] text-right" data-formula="true">BALANCE</th>
                                    </tr>
                                </thead>
                                <tbody id="actual-dsr-table-body">
                                    <!-- Data actual DSR akan dimuat di sini oleh JavaScript -->
                                </tbody>
                                <tfoot id="actual-dsr-table-foot" class="bg-slate-100 font-bold sticky bottom-0">
                                    <!-- Baris Total MTD akan digenerate oleh JavaScript di sini -->
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- BARU: 8. INPUT HOTEL COMPETITOR -->
            <section id="page-input-hotel-competitor" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Selection Header -->
                    <div id="hotel-competitor-selection-header" class="mb-6 pb-6 border-b border-slate-200">
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-end">
                             <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-slate-700 mb-1">Rentang Tanggal</label>
                                <div class="flex items-center gap-2">
                                    <input type="date" id="hotel-competitor-start-date" class="form-input w-full">
                                    <span class="text-slate-500">-</span>
                                    <input type="date" id="hotel-competitor-end-date" class="form-input w-full">
                                </div>
                            </div>
                             <div>
                                <label for="hotel-competitor-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <select id="hotel-competitor-hotel-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <button id="load-hotel-competitor-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-sync-alt mr-1"></i> Muat Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Hotel Competitor Editor Container (hidden by default) -->
                    <div id="hotel-competitor-editor-container" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Input Data Hotel Competitor</h3>
                            <div class="flex items-center gap-2">
                                <button id="add-hotel-competitor-row-btn" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-md shadow transition"><i class="fa-solid fa-plus mr-1"></i> Tambah Baris</button>
                                <button id="save-hotel-competitor-btn" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-md shadow transition"><i class="fa-solid fa-save mr-1"></i> Simpan Data</button>
                            </div>
                        </div>
                        <div class="overflow-auto max-h-[65vh]">
                            <table id="hotel-competitor-table" class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0 z-10">
                                    <tr>
                                        <th class="px-4 py-3 min-w-[150px]">HOTEL NAME</th>
                                        <th class="px-4 py-3 min-w-[100px] text-center"># ROOM</th>
                                        <th class="px-4 py-3 min-w-[150px] text-center">ROOM AVAILABLE</th>
                                        <th class="px-4 py-3 min-w-[150px] text-center">ROOM SOLD</th>
                                        <th class="px-4 py-3 min-w-[100px] text-center">% OCC</th>
                                        <th class="px-4 py-3 min-w-[150px] text-center">ARR</th>
                                        <th class="px-4 py-3 min-w-[150px] text-center">RevPAR</th>
                                        <th class="px-4 py-3 min-w-[150px] text-center">REVENUE</th>
                                        <th class="px-4 py-3 min-w-[120px] text-center">MARKET SHARE</th>
                                        <th class="px-4 py-3 min-w-[100px] text-center">ARI</th>
                                        <th class="px-4 py-3 min-w-[100px] text-center">RGI</th>
                                        <th class="px-4 py-3 min-w-[100px] text-center">MPI</th>
                                        <th class="px-4 py-3 min-w-[100px] text-center">RANK MPI</th>
                                    </tr>
                                </thead>
                                <tbody id="hotel-competitor-table-body">
                                </tbody>
                                <tfoot id="hotel-competitor-table-foot" class="bg-slate-100 font-bold">
                                    <!-- Total row will be generated here by JavaScript -->
                                </tfoot>
                            </table>
                        </div>
                        <!-- BARU: Kontainer untuk Grafik -->
                        <div id="hotel-competitor-charts-container" class="mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6 hidden">
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                                <h4 class="font-bold mb-4 text-slate-700">Market Share</h4>
                                <div class="relative flex-1">
                                    <canvas id="competitor-market-share-chart"></canvas>
                                </div>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                                <div class="flex justify-between items-center mb-4">
                                    <h4 class="font-bold text-slate-700">Analisis Indeks</h4>
                                    <!-- BARU: Tombol Toggle Grafik Indeks -->
                                    <div id="competitor-index-chart-toggles" class="inline-flex rounded-md shadow-sm" role="group">
                                        <button type="button" data-type="mpi" class="stat-toggle-btn active-stat-toggle-btn rounded-l-lg border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-900 hover:bg-slate-50 focus:z-10">
                                            MPI
                                        </button>
                                        <button type="button" data-type="ari" class="stat-toggle-btn border-y border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-900 hover:bg-slate-50 focus:z-10">
                                            ARI
                                        </button>
                                        <button type="button" data-type="rgi" class="stat-toggle-btn border-y border-l border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-900 hover:bg-slate-50 focus:z-10">
                                            RGI
                                        </button>
                                        <button type="button" data-type="all" class="stat-toggle-btn rounded-r-md border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-900 hover:bg-slate-50 focus:z-10">
                                            All
                                        </button>
                                    </div>
                                </div>
                                <div class="relative flex-1">
                                    <canvas id="competitor-mpi-chart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
			
			<section id="page-input-room-production" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Selection Header -->
                    <div id="rp-selection-header" class="mb-6 pb-6 border-b border-slate-200">
                        <h3 class="text-xl font-bold mb-4">Pengaturan Room Production</h3>
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-end">
                            <div>
                                <label for="rp-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="rp-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="rp-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan</label>
                                <select id="rp-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="rp-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <select id="rp-hotel-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <button id="export-rp-template-btn" class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-file-excel mr-1"></i> Export Template
                                </button>
                            </div>
                            <div>
                                <button id="load-rp-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-sync-alt mr-1"></i> Muat Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Room Production Editor Container (hidden by default) -->
                    <div id="room-production-editor-container" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Input Harian Room Production</h3>
                            <div class="flex items-center gap-2" id="rp-action-buttons">
                                <input type="file" id="import-rp-excel-input" class="hidden" accept=".xlsx, .xls">
                                <button id="import-rp-excel-btn" class="bg-emerald-600 hover:bg-emerald-700 text-white text-sm px-4 py-2 rounded-md shadow transition"><i class="fa-solid fa-file-import mr-1"></i> Import Excel</button>
                                <button id="add-room-production-row-btn" class="bg-blue-500 hover:bg-blue-600 text-white text-sm px-4 py-2 rounded-md shadow transition">
                                    <i class="fa-solid fa-plus mr-1"></i> Tambah Baris
                                </button>
                                <button id="save-room-production-btn" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                                    <i class="fa-solid fa-save mr-1"></i> Simpan Data
                                </button>
                            </div>
                        </div>
                        <div class="overflow-auto max-h-[65vh]">
                            <table id="room-production-table" class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0 z-10">
                                    <tr>
                                        <th scope="col" class="px-4 py-3 min-w-[150px]">DATE</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px]">Segment</th>
                                        <th scope="col" class="px-4 py-3 min-w-[200px]">COMPANY</th>
                                        <th scope="col" class="px-4 py-3 min-w-[100px]">ROOM</th>
                                        <th scope="col" class="px-4 py-3 min-w-[100px]">GUEST</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px]">ARR</th>
                                        <th scope="col" class="px-4 py-3 min-w-[150px]">Lodging Revenue</th>
                                        <th scope="col" class="px-4 py-3 min-w-[200px]">PIC Name</th>
                                        <th scope="col" class="px-4 py-3 min-w-[100px] text-center">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="room-production-table-body">
                                    <!-- Data akan dimuat di sini oleh JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- 8. DAILY INCOME DASHBOARD -->
            <section id="page-daily-income-dashboard" class="page-content-wrapper hidden fade-in">
                <!-- Filter Bar -->
                <div class="flex items-center gap-4 mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex-wrap">
                    <h4 class="font-bold text-slate-600 flex-shrink-0">Filter Data:</h4>
                    <!-- Year Filter -->
                    <div>
                        <label for="daily-income-year-filter" class="sr-only">Tahun</label>
                        <select id="daily-income-year-filter" class="form-input">
                            <!-- Opsi tahun akan diisi oleh JavaScript -->
                        </select>
                    </div>
                    <!-- Month Filter -->
                    <div class="flex-grow md:flex-grow-0">
                        <label for="daily-income-month-filter" class="sr-only">Bulan</label>
                        <select id="daily-income-month-filter" class="form-input w-full">
                            <!-- Opsi bulan akan diisi oleh JavaScript -->
                        </select> 
                    </div>
                    <!-- Period Filter -->
                    <div>
                        <label for="daily-income-period-filter" class="sr-only">Periode</label>
                        <select id="daily-income-period-filter" class="form-input w-full">
                            <option value="mtd" selected>Month to Date (MTD)</option>
                            <option value="lastday">Last Day</option>
                            <option value="ytd">Year to Date (YTD)</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    <!-- Custom Date Range Filter (hidden by default) -->
                    <div id="daily-income-custom-date-range" class="hidden flex items-center gap-2">
                        <div>
                            <label for="daily-income-start-date" class="sr-only">Tanggal Mulai</label>
                            <input type="date" id="daily-income-start-date" class="form-input text-sm">
                        </div>
                        <span class="text-slate-500">-</span>
                        <div>
                            <label for="daily-income-end-date" class="sr-only">Tanggal Selesai</label>
                            <input type="date" id="daily-income-end-date" class="form-input text-sm">
                        </div>
                    </div>
                    <!-- Brand Filter -->
                    <div>
                        <label for="daily-income-brand-filter" class="sr-only">Brand</label>
                        <select id="daily-income-brand-filter" class="form-input w-full">
                            <!-- Opsi akan diisi oleh JavaScript -->
                        </select>
                    </div>
                    <!-- Hotel Checklist Filter -->
                    <div class="relative" id="daily-income-hotel-filter-container">
                        <button id="daily-income-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                            <span id="daily-income-hotel-filter-label" class="truncate pr-2">-- Pilih Hotel --</span>
                            <i class="fa-solid fa-chevron-down text-slate-400"></i>
                        </button>
                        <div id="daily-income-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full md:w-72 bg-white rounded-md shadow-lg border border-slate-200 max-h-80 overflow-y-auto right-0 md:right-auto">
                            <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                <input type="text" id="daily-income-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                <div class="flex justify-between items-center gap-4">
                                    <label class="flex items-center space-x-2 cursor-pointer flex-shrink-0">
                                        <input type="checkbox" id="daily-income-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                        <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                    </label>
                                    <button id="daily-income-hotel-filter-apply" class="flex-grow bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 px-3 rounded-md transition">Terapkan Filter</button>
                                </div>
                            </div>
                            <div id="daily-income-hotel-checklist-container" class="p-2 space-y-2">
                                <!-- Checklist hotel akan diisi oleh JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Grid (Placeholder) -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 relative">
                    <!-- Loader Overlay -->
                    <div id="daily-income-loader" class="absolute inset-0 bg-white/50 backdrop-blur-sm flex items-center justify-center z-10 rounded-xl hidden">
                        <i class="fa-solid fa-circle-notch fa-spin text-3xl text-blue-500"></i>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100" id="daily-stats-arr-card">
                        <p class="text-xs text-slate-500 font-bold uppercase">ARR</p>
                        <h3 id="daily-stats-arr" class="text-2xl font-bold mt-1 text-slate-800">...</h3>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100" id="daily-stats-revpar-card">
                        <p class="text-xs text-slate-500 font-bold uppercase">RevPAR</p>
                        <h3 id="daily-stats-revpar" class="text-2xl font-bold mt-1 text-slate-800">...</h3>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100" id="daily-stats-total-revenue-card">
                        <p class="text-xs text-slate-500 font-bold uppercase">Total Revenue</p>
                        <h3 id="daily-stats-total-revenue" class="text-2xl font-bold mt-1 text-slate-800">...</h3>
                    </div>
                </div>

                <!-- Charts (Placeholder) -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Occupancy Gauge Chart -->
                    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex flex-col" id="daily-stats-occupancy-card">
                        <p class="text-xs text-slate-500 font-bold uppercase">Avg. Occupancy</p>
                        <div class="relative flex-1 w-full mt-2 flex items-center justify-center"><canvas id="dailyOccupancyGaugeChart"></canvas></div>
                    </div>
                    <!-- Daily Income Trend Chart -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                        <h4 id="daily-income-chart-title" class="font-bold mb-4">Tren Pendapatan Harian (Actual vs Budget)</h4>
                        <div class="relative flex-1"><canvas id="dailyIncomeChart"></canvas></div>
                    </div>
                </div>

                <!-- BARU: Tabel Ringkasan Performa Hotel -->
                <div class="mt-6 bg-white p-6 rounded-xl shadow-sm border border-slate-100" id="daily-summary-table-card">
                    <h4 class="font-bold mb-4">Ringkasan Performa Hotel</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-500" id="daily-income-summary-table">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th rowspan="2" class="px-4 py-3 border-b border-slate-200 align-bottom sticky left-0 bg-slate-50">Hotel Name</th>
                                    <th colspan="4" class="px-4 py-3 text-center border-b border-slate-200">Budget</th>
                                    <th colspan="4" class="px-4 py-3 text-center border-b border-slate-200">Actual</th>
                                    <th colspan="4" class="px-4 py-3 text-center border-b border-slate-200">Variance</th>
                                </tr>
                                <tr>
                                    <!-- Budget -->
                                    <th class="px-4 py-3 text-right">Occ %</th>
                                    <th class="px-4 py-3 text-right">ARR</th>
                                    <th class="px-4 py-3 text-right">RevPAR</th>
                                    <th class="px-4 py-3 text-right">Total Revenue</th>
                                    <!-- Actual -->
                                    <th class="px-4 py-3 text-right">Occ %</th>
                                    <th class="px-4 py-3 text-right">ARR</th>
                                    <th class="px-4 py-3 text-right">RevPAR</th>
                                    <th class="px-4 py-3 text-right">Total Revenue</th>
                                    <!-- Variance -->
                                    <th class="px-4 py-3 text-right">Occ %</th>
                                    <th class="px-4 py-3 text-right">ARR</th>
                                    <th class="px-4 py-3 text-right">RevPAR</th>
                                    <th class="px-4 py-3 text-right">Total Revenue</th>
                                </tr>
                            </thead>
                            <tbody id="daily-income-summary-table-body">
                                <!-- Data ringkasan hotel akan dimuat di sini oleh JavaScript -->
                                <tr><td colspan="13" class="p-8 text-center text-slate-500">
                                    <i class="fa-solid fa-circle-notch fa-spin text-2xl"></i><p class="mt-2">Memuat data ringkasan...</p>
                                </td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- 9. REPORTS -->
            <section id="page-reports" class="page-content-wrapper hidden fade-in">
                <!-- Grid untuk menu utama laporan -->
                <div id="reports-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

                    <!-- Kartu Laporan Income Statement -->
                    <button onclick="window.location.hash = '#reports/income-statement'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-cyan-100 text-cyan-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-file-invoice-dollar text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Income Statement</h3>
                                <p class="text-sm text-slate-500">Laporan Laba Rugi (Actual vs Budget).</p>
                            </div>
                        </div>
                    </button>

                    <!-- Kartu Laporan Room Division -->
                    <button onclick="window.location.hash = '#reports/room-division'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-indigo-100 text-indigo-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-bed text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">Room Division</h3>
                                <p class="text-sm text-slate-500">Analisis performa divisi kamar.</p>
                            </div>
                        </div>
                    </button>

                    <!-- Kartu Laporan F&B Division -->
                    <button onclick="window.location.hash = '#reports/fnb-division'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-amber-100 text-amber-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-utensils text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">F&B Division</h3>
                                <p class="text-sm text-slate-500">Analisis performa divisi F&B.</p>
                            </div>
                        </div>
                    </button>

                    <!-- BARU: Kartu Laporan Monthly Hotel Summary -->
                    <button onclick="window.location.hash = '#reports/monthly-summary'" class="text-left bg-white p-6 rounded-xl shadow-sm border border-slate-100 hover:shadow-md hover:-translate-y-1 transition-all duration-300">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-12 h-12 bg-rose-100 text-rose-600 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fa-solid fa-chart-simple text-xl"></i>
                            </div>
                            <div>
                                <h3 class="font-bold text-lg">DSR Monthly Hotel Summary</h3>
                                <p class="text-sm text-slate-500">Ringkasan performa bulanan per hotel.</p>
                            </div>
                        </div>
                    </button>

                </div>

                <!-- Placeholder untuk Konten Detail Laporan -->
                <div id="report-income-statement" class="report-detail-content hidden">
                    <!-- Header & Filter -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 mb-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold">Income Statement (Actual vs Budget)</h3>
                                <p class="text-sm text-slate-500">Bandingkan performa keuangan aktual dengan budget tahunan.</p>
                            </div>
                            <button onclick="window.location.hash = '#reports'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                                <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                            </button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 items-end pt-4 border-t border-slate-200">
                            <div>
                                <label for="is-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="is-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="is-brand-select" class="block text-sm font-medium text-slate-700 mb-1">Brand</label>
                                <select id="is-brand-select" class="form-input w-full"></select>
                            </div>
                            <!-- Hotel Checklist Filter -->
                            <div class="relative" id="is-hotel-filter-container">
                                <label for="is-hotel-filter-btn" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <button id="is-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                                    <span id="is-hotel-filter-label" class="truncate pr-2">-- Pilih Hotel --</span>
                                    <i class="fa-solid fa-chevron-down text-slate-400"></i>
                                </button>
                                <div id="is-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full md:w-72 bg-white rounded-md shadow-lg border border-slate-200 max-h-80 overflow-y-auto right-0 md:right-auto">
                                    <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                        <input type="text" id="is-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                        <div class="flex justify-between items-center gap-4">
                                            <label class="flex items-center space-x-2 cursor-pointer flex-shrink-0">
                                                <input type="checkbox" id="is-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                                <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                            </label>
                                            <button id="is-hotel-filter-apply" class="flex-grow bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 px-3 rounded-md transition">Terapkan</button>
                                        </div>
                                    </div>
                                    <div id="is-hotel-checklist-container" class="p-2 space-y-2">
                                        <!-- Checklist hotel akan diisi oleh JavaScript -->
                                    </div>
                                </div>
                            </div>
                            <div>
                                <button id="generate-is-report-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-cogs mr-1"></i> Generate Laporan
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Konten Laporan (Tabel) -->
                    <div id="is-report-container" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 min-w-[250px]">Description</th>
                                        <th scope="col" class="px-6 py-3 min-w-[150px] text-right">Budget (YTD)</th>
                                        <th scope="col" class="px-6 py-3 min-w-[150px] text-right">Actual (YTD)</th>
                                        <th scope="col" class="px-6 py-3 min-w-[150px] text-right">Variance</th>
                                        <th scope="col" class="px-6 py-3 min-w-[100px] text-right">Variance (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="is-report-table-body">
                                    <!-- Data laporan akan di-generate oleh JavaScript -->
                                    <tr><td colspan="5" class="p-4 text-center text-slate-400">Pilih filter dan klik "Generate Laporan" untuk melihat data.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="report-room-division" class="report-detail-content hidden">
                    <!-- Header & Filter -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 mb-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold">Room Division Report (Actual vs Budget)</h3>
                                <p class="text-sm text-slate-500">Analisis performa divisi kamar.</p>
                            </div>
                            <button onclick="window.location.hash = '#reports'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                                <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                            </button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 items-end pt-4 border-t border-slate-200">
                            <div>
                                <label for="rd-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="rd-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="rd-start-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan Mulai</label>
                                <select id="rd-start-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="rd-end-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan Selesai</label>
                                <select id="rd-end-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="rd-brand-select" class="block text-sm font-medium text-slate-700 mb-1">Brand</label>
                                <select id="rd-brand-select" class="form-input w-full"></select>
                            </div>
                            <!-- Hotel Checklist Filter -->
                            <div class="relative lg:col-span-2" id="rd-hotel-filter-container">
                                <label for="rd-hotel-filter-btn" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <button id="rd-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                                    <span id="rd-hotel-filter-label" class="truncate pr-2">-- Semua Hotel --</span>
                                    <i class="fa-solid fa-chevron-down text-slate-400"></i>
                                </button>
                                <div id="rd-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full md:w-72 bg-white rounded-md shadow-lg border border-slate-200 max-h-80 overflow-y-auto right-0 md:right-auto">
                                    <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                        <input type="text" id="rd-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                        <div class="flex justify-between items-center gap-4">
                                            <label class="flex items-center space-x-2 cursor-pointer flex-shrink-0">
                                                <input type="checkbox" id="rd-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                                <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                            </label>
                                            <button id="rd-hotel-filter-apply" class="flex-grow bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 px-3 rounded-md transition">Terapkan</button>
                                        </div>
                                    </div>
                                    <div id="rd-hotel-checklist-container" class="p-2 space-y-2">
                                        <!-- Checklist hotel akan diisi oleh JavaScript -->
                                    </div>
                                </div>
                            </div>
                            <div class="lg:col-span-6">
                                <button id="generate-rd-report-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-cogs mr-1"></i> Generate Laporan
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Konten Laporan (Tabel) -->
                    <div id="rd-report-container" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 min-w-[250px]">Description</th>
                                        <th id="rd-budget-header" scope="col" class="px-6 py-3 min-w-[150px] text-right">Budget (Period)</th>
                                        <th id="rd-actual-header" scope="col" class="px-6 py-3 min-w-[150px] text-right">Actual (Period)</th>
                                        <th scope="col" class="px-6 py-3 min-w-[150px] text-right">Variance</th>
                                        <th scope="col" class="px-6 py-3 min-w-[100px] text-right">Variance (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="rd-report-table-body">
                                    <!-- Data laporan akan di-generate oleh JavaScript -->
                                    <tr><td colspan="5" class="p-4 text-center text-slate-400">Pilih filter dan klik "Generate Laporan" untuk melihat data.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div id="report-fnb-division" class="report-detail-content hidden">
                    <!-- Header & Filter -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 mb-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold">F&B Division Report (Actual vs Budget)</h3>
                                <p class="text-sm text-slate-500">Analisis performa divisi Food & Beverage.</p>
                            </div>
                            <button onclick="window.location.hash = '#reports'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                                <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                            </button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 items-end pt-4 border-t border-slate-200">
                            <div>
                                <label for="fnb-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="fnb-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="fnb-start-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan Mulai</label>
                                <select id="fnb-start-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="fnb-end-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan Selesai</label>
                                <select id="fnb-end-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="fnb-brand-select" class="block text-sm font-medium text-slate-700 mb-1">Brand</label>
                                <select id="fnb-brand-select" class="form-input w-full"></select>
                            </div>
                            <!-- Hotel Checklist Filter -->
                            <div class="relative lg:col-span-2" id="fnb-hotel-filter-container">
                                <label for="fnb-hotel-filter-btn" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <button id="fnb-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                                    <span id="fnb-hotel-filter-label" class="truncate pr-2">-- Semua Hotel --</span>
                                    <i class="fa-solid fa-chevron-down text-slate-400"></i>
                                </button>
                                <div id="fnb-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full md:w-72 bg-white rounded-md shadow-lg border border-slate-200 max-h-80 overflow-y-auto right-0 md:right-auto">
                                    <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                        <input type="text" id="fnb-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                        <div class="flex justify-between items-center gap-4">
                                            <label class="flex items-center space-x-2 cursor-pointer flex-shrink-0">
                                                <input type="checkbox" id="fnb-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                                <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                            </label>
                                            <button id="fnb-hotel-filter-apply" class="flex-grow bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 px-3 rounded-md transition">Terapkan</button>
                                        </div>
                                    </div>
                                    <div id="fnb-hotel-checklist-container" class="p-2 space-y-2">
                                        <!-- Checklist hotel akan diisi oleh JavaScript -->
                                    </div>
                                </div>
                            </div>
                            <div class="lg:col-span-6">
                                <button id="generate-fnb-report-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-cogs mr-1"></i> Generate Laporan
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Konten Laporan (Tabel) -->
                    <div id="fnb-report-container" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 min-w-[250px]">Description</th>
                                        <th scope="col" class="px-6 py-3 min-w-[150px] text-right">Budget (Period)</th>
                                        <th scope="col" class="px-6 py-3 min-w-[150px] text-right">Actual (Period)</th>
                                        <th scope="col" class="px-6 py-3 min-w-[150px] text-right">Variance</th>
                                        <th scope="col" class="px-6 py-3 min-w-[100px] text-right">Variance (%)</th>
                                    </tr>
                                </thead>
                                <tbody id="fnb-report-table-body">
                                    <!-- Data laporan akan di-generate oleh JavaScript -->
                                    <tr><td colspan="5" class="p-4 text-center text-slate-400">Pilih filter dan klik "Generate Laporan" untuk melihat data.</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- BARU: Halaman Laporan Monthly Summary -->
                <div id="report-monthly-summary" class="report-detail-content hidden">
                    <!-- Header & Filter -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 mb-6">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold">DSR Monthly Hotel Summary</h3>
                                <p class="text-sm text-slate-500">Ringkasan performa bulanan (Occ, ARR, RevPAR) per hotel.</p>
                            </div>
                            <button onclick="window.location.hash = '#reports'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                                <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                            </button>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 items-end pt-4 border-t border-slate-200">
                            <div>
                                <label for="ms-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="ms-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="ms-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan</label>
                                <select id="ms-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="ms-brand-select" class="block text-sm font-medium text-slate-700 mb-1">Brand</label>
                                <select id="ms-brand-select" class="form-input w-full"></select>
                            </div>
                            <!-- Hotel Checklist Filter -->
                            <div class="relative lg:col-span-2" id="ms-hotel-filter-container">
                                <label for="ms-hotel-filter-btn" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <button id="ms-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                                    <span id="ms-hotel-filter-label" class="truncate pr-2">-- Semua Hotel --</span>
                                    <i class="fa-solid fa-chevron-down text-slate-400"></i>
                                </button>
                                <div id="ms-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full md:w-72 bg-white rounded-md shadow-lg border border-slate-200 max-h-80 overflow-y-auto right-0 md:right-auto">
                                    <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                        <input type="text" id="ms-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                        <div class="flex justify-between items-center gap-4">
                                            <label class="flex items-center space-x-2 cursor-pointer flex-shrink-0">
                                                <input type="checkbox" id="ms-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                                <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                            </label>
                                            <button id="ms-hotel-filter-apply" class="flex-grow bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 px-3 rounded-md transition">Terapkan</button>
                                        </div>
                                    </div>
                                    <div id="ms-hotel-checklist-container" class="p-2 space-y-2">
                                        <!-- Checklist hotel akan diisi oleh JavaScript -->
                                    </div>
                                </div>
                            </div>
                            <div class="lg:col-span-5">
                                <button id="generate-ms-report-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-cogs mr-1"></i> Generate Laporan
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Konten Laporan (Tabel) -->
                    <div id="ms-report-container" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <div class="overflow-x-auto" id="ms-report-table-container">
                            <!-- Tabel akan digenerate oleh JavaScript di sini -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- 12. INPUT AR AGING -->
            <section id="page-input-ar-aging" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Selection Header -->
                    <div id="ar-aging-selection-header" class="mb-6 pb-6 border-b border-slate-200">
                        <h3 class="text-xl font-bold mb-4">Pengaturan AR Aging</h3>
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-4 items-end">
                            <div>
                                <label for="ar-aging-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="ar-aging-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="ar-aging-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan</label>
                                <select id="ar-aging-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="ar-aging-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                                <select id="ar-aging-hotel-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <button id="export-ar-aging-template-btn" class="w-full bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-file-excel mr-1"></i> Export Template
                                </button>
                            </div>
                            <div>
                                <button id="load-ar-aging-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-sync-alt mr-1"></i> Muat Data
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- AR Aging Editor Container (hidden by default) -->
                    <div id="ar-aging-editor-container" class="hidden">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-bold">Input Data AR Aging</h3>
                            <div class="flex items-center gap-2">
                                <button id="add-ar-aging-row-btn" class="bg-blue-600 hover:bg-blue-700 text-white text-sm px-4 py-2 rounded-md shadow transition"><i class="fa-solid fa-plus mr-1"></i> Tambah Baris</button>
                                <input type="file" id="import-ar-aging-excel-input" class="hidden" accept=".xlsx, .xls">
                                <button id="import-ar-aging-excel-btn" class="bg-emerald-600 hover:bg-emerald-700 text-white text-sm px-4 py-2 rounded-md shadow transition flex items-center">
                                    <i class="fa-solid fa-file-import mr-2"></i>Import Excel
                                </button>
                                <button id="save-ar-aging-btn" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-md shadow transition"><i class="fa-solid fa-save mr-1"></i> Simpan Data</button>
                            </div>
                        </div>
                        <div class="overflow-auto max-h-[65vh]">
                            <table id="ar-aging-table" class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0 z-10">
                                    <tr><th class="px-4 py-3 min-w-[200px]">Nama Perusahaan/Tamu</th><th class="px-4 py-3 min-w-[150px]">No. Invoice</th><th class="px-4 py-3 min-w-[120px]">Tgl. Invoice</th><th class="px-4 py-3 min-w-[150px] text-right">Total Tagihan</th><th class="px-4 py-3 min-w-[150px] text-right">Current</th><th class="px-4 py-3 min-w-[150px] text-right">1-30 Hari</th><th class="px-4 py-3 min-w-[150px] text-right">31-60 Hari</th><th class="px-4 py-3 min-w-[150px] text-right">61-90 Hari</th><th class="px-4 py-3 min-w-[150px] text-right">> 90 Hari</th><th class="px-4 py-3 min-w-[200px]">Keterangan</th><th class="px-4 py-3 min-w-[100px] text-center">Aksi</th></tr>
                                </thead>
                                <tbody id="ar-aging-table-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- BARU: 12.1 AR SUMMARY -->
            <section id="page-ar-summary" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Selection Header -->
                    <div id="ar-summary-selection-header" class="mb-6 pb-6 border-b border-slate-200">
                        <h3 class="text-xl font-bold mb-4">AR Aging Summary</h3>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 items-end">
                            <div>
                                <label for="ar-summary-year-select" class="block text-sm font-medium text-slate-700 mb-1">Tahun</label>
                                <select id="ar-summary-year-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <label for="ar-summary-month-select" class="block text-sm font-medium text-slate-700 mb-1">Bulan</label>
                                <select id="ar-summary-month-select" class="form-input w-full"></select>
                            </div>
                            <div>
                                <button id="load-ar-summary-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-sync-alt mr-1"></i> Muat Ringkasan
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- AR Summary Table Container -->
                    <div id="ar-summary-container">
                        <div class="overflow-auto max-h-[65vh]">
                            <table id="ar-summary-table" class="w-full text-sm text-left text-slate-500">
                                <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0 z-10">
                                    <tr>
                                        <th class="px-4 py-3 min-w-[200px] sticky left-0 bg-slate-50 z-10">Nama Hotel</th>
                                        <th class="px-4 py-3 min-w-[150px] text-right">Current</th>
                                        <th class="px-4 py-3 min-w-[150px] text-right">1-30 Hari</th>
                                        <th class="px-4 py-3 min-w-[150px] text-right">31-60 Hari</th>
                                        <th class="px-4 py-3 min-w-[150px] text-right">61-90 Hari</th>
                                        <th class="px-4 py-3 min-w-[150px] text-right">> 90 Hari</th>
                                        <th class="px-4 py-3 min-w-[150px] text-right font-bold">Total AR</th>
                                    </tr>
                                </thead>
                                <tbody id="ar-summary-table-body">
                                    <tr><td colspan="7" class="p-8 text-center text-slate-500">
                                        <p>Pilih filter di atas dan klik "Muat Ringkasan" untuk menampilkan data.</p>
                                    </td></tr>
                                </tbody>
                                <tfoot id="ar-summary-table-foot" class="bg-slate-100 font-bold sticky bottom-0">
                                    <!-- Total row will be generated here -->
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- BARU: 12.1 AR SUMMARY -->
            <section id="page-inspection-dashboard" class="page-content-wrapper hidden fade-in">
                <!-- Filter Bar -->
                <div class="flex items-center gap-4 mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-100 flex-wrap">
                    <h4 class="font-bold text-slate-600 flex-shrink-0">Filter Data:</h4>
                    <div><label for="inspection-dashboard-year-filter" class="sr-only">Tahun</label><select id="inspection-dashboard-year-filter" class="form-input"></select></div>
                    <div><label for="inspection-dashboard-month-filter" class="sr-only">Bulan</label><select id="inspection-dashboard-month-filter" class="form-input w-full"></select></div>
                    <div class="relative" id="inspection-dashboard-hotel-filter-container">
                        <button id="inspection-dashboard-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                            <span id="inspection-dashboard-hotel-filter-label" class="truncate pr-2">-- Pilih Hotel --</span>
                            <i class="fa-solid fa-chevron-down text-slate-400"></i>
                        </button>
                        <div id="inspection-dashboard-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full md:w-72 bg-white rounded-md shadow-lg border border-slate-200 max-h-80 overflow-y-auto right-0">
                            <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                <input type="text" id="inspection-dashboard-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                <div class="flex justify-between items-center gap-4">
                                    <label class="flex items-center space-x-2 cursor-pointer flex-shrink-0">
                                        <input type="checkbox" id="inspection-dashboard-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                        <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                    </label>
                                    <button id="inspection-dashboard-hotel-filter-apply" class="flex-grow bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold py-2 px-3 rounded-md transition">Terapkan</button>
                                </div>
                            </div>
                            <div id="inspection-dashboard-hotel-checklist-container" class="p-2 space-y-2">
                                <!-- Checklist akan diisi oleh JavaScript -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-center gap-5"><div class="w-12 h-12 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-clipboard-list text-xl"></i></div><div><p class="text-sm text-slate-500 font-medium">Total Inspections</p><h3 id="inspection-stats-total" class="text-2xl font-bold text-slate-800">124</h3><p class="text-xs text-slate-400">This Month</p></div></div>
                    <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-center gap-5"><div class="w-12 h-12 bg-green-100 text-green-600 rounded-full flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-star-half-alt text-xl"></i></div><div><p class="text-sm text-slate-500 font-medium">Average Score</p><h3 id="inspection-stats-avg-score" class="text-2xl font-bold text-slate-800">88.5</h3><p class="text-xs text-slate-400">out of 100</p></div></div>
                    <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-center gap-5"><div class="w-12 h-12 bg-yellow-100 text-yellow-600 rounded-full flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-list-check text-xl"></i></div><div><p class="text-sm text-slate-500 font-medium">Open Tasks</p><h3 id="inspection-stats-open-tasks" class="text-2xl font-bold text-slate-800">32</h3><p class="text-xs text-slate-400">Pending Action</p></div></div>
                    <div class="bg-white p-5 rounded-xl shadow-sm border border-slate-100 flex items-center gap-5"><div class="w-12 h-12 bg-red-100 text-red-600 rounded-full flex items-center justify-center flex-shrink-0"><i class="fa-solid fa-calendar-times text-xl"></i></div><div><p class="text-sm text-slate-500 font-medium">Overdue Tasks</p><h3 id="inspection-stats-overdue-tasks" class="text-2xl font-bold text-slate-800">5</h3><p class="text-xs text-slate-400">Action Required</p></div></div>
                </div>

                <!-- Charts & Recent Activity -->
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Kolom Kiri: Charts -->
                    <div class="lg:col-span-2 grid grid-cols-1 gap-6">
                        <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                            <h4 class="font-bold mb-4">Average Score Trend</h4>
                            <div class="relative flex-1"><canvas id="inspection-score-trend-chart"></canvas></div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-80 flex flex-col">
                                <h4 class="font-bold mb-4">Inspections by Type</h4>
                                <div class="relative flex-1"><canvas id="inspection-type-distribution-chart"></canvas></div>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-80 flex flex-col">
                                <h4 class="font-bold mb-4">Tasks by Priority</h4>
                                <div class="relative flex-1"><canvas id="inspection-task-priority-chart"></canvas></div>
                            </div>
                        </div>
                    </div>

                    <!-- Kolom Kanan: Recent Activity -->
                    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <h4 class="font-bold mb-4">Recent Activity</h4>
                        <ul id="inspection-recent-activity-list" class="space-y-4">
                            <!-- Contoh item aktivitas -->
                            <li class="flex items-start gap-3"><div class="w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center flex-shrink-0 text-sm"><i class="fa-solid fa-check"></i></div><div><p class="text-sm font-medium text-slate-800">Hotel Aston Bali completed a Kitchen Inspection</p><p class="text-xs text-slate-500">Today, 10:30 AM</p></div></li>
                            <li class="flex items-start gap-3"><div class="w-8 h-8 bg-red-100 text-red-600 rounded-full flex items-center justify-center flex-shrink-0 text-sm"><i class="fa-solid fa-flag"></i></div><div><p class="text-sm font-medium text-slate-800">New high-priority task created for Grand Hotel Jakarta</p><p class="text-xs text-slate-500">Today, 09:15 AM</p></div></li>
                            <li class="flex items-start gap-3"><div class="w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center flex-shrink-0 text-sm"><i class="fa-solid fa-plus"></i></div><div><p class="text-sm font-medium text-slate-800">Room Inspection started at Hotel Ibis Surabaya</p><p class="text-xs text-slate-500">Yesterday, 02:00 PM</p></div></li>
                            <!-- Data aktivitas akan diisi oleh JavaScript -->
                        </ul>
                    </div>
                </div>
            </section>

            <!-- BARU: 14. HOTEL INSPECTION -->
            <section id="page-hotel-inspection" class="page-content-wrapper hidden fade-in">
                <!-- Kontainer Utama untuk Riwayat Inspeksi -->
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Header dengan Judul dan Tombol Aksi -->
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 pb-4 border-b border-slate-200">
                        <h3 class="text-xl font-bold text-slate-800">Riwayat Inspeksi</h3>
                        <button onclick="openStartInspectionModal()" class="mt-3 md:mt-0 w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition shadow-lg shadow-blue-500/20">
                            <i class="fa-solid fa-plus mr-2"></i>Mulai Inspeksi Baru
                        </button>
                    </div>

                    <!-- BARU: Filter Section -->
                    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-4 p-4 bg-slate-50 rounded-lg border">
                        <div>
                            <label for="history-filter-hotel" class="text-sm font-medium text-slate-600">Hotel</label>
                            <select id="history-filter-hotel" class="form-input w-full mt-1"></select>
                        </div>
                        <div>
                            <label for="history-filter-type" class="text-sm font-medium text-slate-600">Tipe Inspeksi</label>
                            <select id="history-filter-type" class="form-input w-full mt-1"></select>
                        </div>
                        <div>
                            <label for="history-filter-area" class="text-sm font-medium text-slate-600">Area/Kamar</label>
                            <input type="text" id="history-filter-area" class="form-input w-full mt-1" placeholder="Cari area...">
                        </div>
                        <div>
                            <label for="history-filter-pic" class="text-sm font-medium text-slate-600">PIC</label>
                            <input type="text" id="history-filter-pic" class="form-input w-full mt-1" placeholder="Cari PIC...">
                        </div>
                        <div>
                            <label for="history-filter-status" class="text-sm font-medium text-slate-600">Status</label>
                            <select id="history-filter-status" class="form-input w-full mt-1"><option value="all">Semua Status</option><option value="completed">Selesai</option><option value="in_progress">Berlangsung</option></select>
                        </div>
                        <div class="col-span-2 lg:col-span-2"><label class="text-sm font-medium text-slate-600">Rentang Tanggal</label><div class="flex items-center gap-2 mt-1"><input type="date" id="history-filter-start-date" class="form-input w-full"><span class="text-slate-500">-</span><input type="date" id="history-filter-end-date" class="form-input w-full"></div></div>
                        <div class="col-span-2 md:col-span-4 lg:col-span-6 flex justify-end items-center gap-3 pt-2">
                            <button id="history-filter-reset-btn" class="text-sm text-slate-600 hover:text-slate-800">Reset Filter</button>
                            <!-- BARU: Tombol Export Excel -->
                            <button id="history-export-excel-btn" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-2 px-4 rounded-lg transition"><i class="fa-solid fa-file-excel mr-2"></i>Export Excel</button>
                            <button id="history-filter-apply-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg"><i class="fa-solid fa-filter mr-2"></i>Terapkan Filter</button>
                        </div>
                    </div>

                    <!-- Tabel Riwayat Inspeksi -->
                    <div class="overflow-x-auto">
                        <table id="inspection-history-table" class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3">Tanggal</th><th scope="col" class="px-6 py-3">Hotel</th><th scope="col" class="px-6 py-3">Tipe</th><th scope="col" class="px-6 py-3">Area/Kamar</th><th scope="col" class="px-6 py-3">PIC</th><th scope="col" class="px-6 py-3">Skor</th><th scope="col" class="px-6 py-3">Status</th><th scope="col" class="px-6 py-3 text-center">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="inspection-history-table-body">
                                <tr>
                                    <td colspan="6" class="text-center p-8 text-slate-500"><i class="fa-solid fa-circle-notch fa-spin mr-2"></i> Memuat riwayat inspeksi...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- BARU: Kontrol Paginasi -->
                    <div class="flex items-center justify-between border-t border-slate-200 bg-white px-4 py-3 sm:px-6 mt-4 rounded-b-lg">
                        <div id="inspection-pagination-info" class="text-sm text-slate-700"></div>
                        <div id="inspection-pagination-controls"></div>
                    </div>
                </div>
            </section>

            <!-- BARU: 16. HALAMAN FORMULIR INSPEKSI -->
            <section id="page-inspection-form" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100" id="inspection-printable-area">
                    <!-- Header Halaman -->
                    <div class="flex justify-between items-center mb-6 pb-4 border-b border-slate-200">
                        <div>
                            <h3 id="inspection-form-title" class="text-xl font-bold text-slate-800">Mengisi Formulir Inspeksi</h3>
                            <p id="inspection-form-subtitle" class="text-sm text-slate-500">Memuat detail...</p>
                        </div>
                        <button onclick="window.location.hash = '#hotel-inspection'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                            <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                        </button>
                    </div>
                    <div id="inspection-form-content"></div>
                </div>
            </section>

            <!-- BARU: 15. TASK TO DO -->
            <section id="page-task-to-do" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Header dan Filter -->
                    <div class="flex flex-col md:flex-row justify-between items-center mb-6 pb-4 border-b border-slate-200 gap-4">
                        <h3 class="text-xl font-bold text-slate-800">Daftar Tugas (Task to Do)</h3>
                        <div class="flex items-center gap-2 flex-wrap justify-start md:justify-end">
                            <select id="task-hotel-filter" class="form-input text-sm w-full sm:w-auto">
                                <!-- Opsi hotel akan diisi oleh JavaScript -->
                            </select>
                            <select id="task-status-filter" class="form-input text-sm w-auto">
                                <option value="all" selected>Semua Status</option>
                                <option value="pending">Pending</option>
                                <option value="in_progress">In Progress</option>
                                <option value="completed">Completed</option>
                                <option value="overdue">Overdue</option>
                            </select>
                            <select id="task-priority-filter" class="form-input text-sm w-auto">
                                <option value="all">Semua Prioritas</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                            <button id="clear-task-filters-btn" class="text-sm text-slate-500 hover:text-blue-600 transition" title="Reset Filter">
                                <i class="fa-solid fa-xmark-circle"></i> Reset
                            </button>
                        </div>
                    </div>

                    <!-- Daftar Tugas -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3">Tanggal Dibuat</th>
                                    <th scope="col" class="px-6 py-3">Hotel</th>
                                    <th scope="col" class="px-6 py-3">Area/Kamar</th>
                                    <th scope="col" class="px-6 py-3">Deskripsi Tugas</th>
                                    <th scope="col" class="px-6 py-3 text-center">Prioritas</th>
                                    <th scope="col" class="px-6 py-3">PIC</th>
                                    <th scope="col" class="px-6 py-3 text-center">Status</th>
                                    <th scope="col" class="px-6 py-3 text-center">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="task-list-table-body">
                                <!-- Data tugas akan dimuat di sini oleh JavaScript -->
                            </tbody>
                        </table>
                        </div>
                </div>
            </section>

            <!-- BARU: PLACEHOLDER UNTUK HALAMAN GUEST REVIEW -->
            <section id="page-guest-review-dashboard" class="page-content-wrapper hidden fade-in">
                <!-- Filter Bar -->
                <div class="flex items-center gap-4 mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-100">
                    <h4 class="font-bold text-slate-600 flex-shrink-0">Filter:</h4>
                    <div class="flex-grow">
                        <label for="review-dashboard-hotel-filter" class="sr-only">Hotel</label>
                        <select id="review-dashboard-hotel-filter" class="form-input w-full"></select>
                    </div>
                    <div class="flex-grow">
                        <label for="review-dashboard-date-filter" class="sr-only">Periode</label>
                        <select id="review-dashboard-date-filter" class="form-input w-full">
                            <option value="last30days" selected>30 Hari Terakhir</option>
                            <option value="this_month">Bulan Ini</option>
                            <option value="last_month">Bulan Lalu</option>
                            <option value="last90days">90 Hari Terakhir</option>
                            <option value="all_time">Semua Waktu</option>
                        </select>
                    </div>
                    <button id="review-dashboard-filter-apply-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                        <i class="fa-solid fa-filter mr-2"></i>Terapkan
                    </button>
                </div>

                <!-- Stats Grid -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-5 rounded-xl shadow-sm border"><p class="text-sm font-medium text-slate-500">Total Ulasan</p><h3 id="review-stats-total-reviews" class="text-3xl font-bold text-slate-800 mt-1">...</h3></div>
                    <div class="bg-white p-5 rounded-xl shadow-sm border"><p class="text-sm font-medium text-slate-500">Rata-rata Rating</p><h3 id="review-stats-avg-rating" class="text-3xl font-bold text-slate-800 mt-1">...</h3><div id="review-stats-avg-rating-stars" class="text-lg mt-1"></div></div>
                    <div class="bg-white p-5 rounded-xl shadow-sm border"><p class="text-sm font-medium text-slate-500">Perlu Dibalas</p><h3 id="review-stats-unreplied" class="text-3xl font-bold text-slate-800 mt-1">...</h3></div>
                    <div class="bg-white p-5 rounded-xl shadow-sm border"><p class="text-sm font-medium text-slate-500">Tingkat Respons</p><h3 id="review-stats-response-rate" class="text-3xl font-bold text-slate-800 mt-1">...</h3></div>
                </div>

                <!-- Charts Grid -->
                <div class="grid grid-cols-1 lg:grid-cols-5 gap-6">
                    <!-- Rating Distribution Chart (2/5 width) -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                        <h4 class="font-bold mb-4">Distribusi Rating</h4>
                        <div class="relative flex-1"><canvas id="ratingDistributionChart"></canvas></div>
                    </div>
                    <!-- Monthly Trend Chart (3/5 width) -->
                    <div class="lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                        <h4 class="font-bold mb-4">Tren Rating Bulanan</h4>
                        <div class="relative flex-1"><canvas id="monthlyTrendChart"></canvas></div>
                    </div>
                </div>

                <!-- BARU: Grid untuk Grafik & Aktivitas -->
                <div class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Grafik Rating Per Hotel (2/3 width) -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                        <h4 class="font-bold mb-4">Rata-rata Rating per Hotel</h4>
                        <div class="relative flex-1">
                            <canvas id="hotelRatingChart"></canvas>
                        </div>
                    </div>

                    <!-- Aktivitas Terbaru (1/3 width) -->
                    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-sm border border-slate-100 h-96 flex flex-col">
                        <h4 class="font-bold mb-4">Aktivitas Terbaru</h4>
                        <ul id="review-recent-activity-list" class="space-y-4 overflow-y-auto flex-1 pr-2">
                            <!-- Aktivitas akan diisi oleh JavaScript -->
                        </ul>
                    </div>
                </div>
            </section>
            <!-- BARU: Halaman Pengaturan Form Guest Review -->
            <section id="page-guest-review-settings" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <div class="mb-6 pb-4 border-b border-slate-200">
                        <h3 class="text-xl font-bold">Pengaturan Form Guest Review</h3>
                        <p class="text-sm text-slate-500 mt-1">Kustomisasi tampilan formulir ulasan untuk setiap hotel.</p>
                    </div>
                    <!-- Filter Hotel -->
                    <div class="mb-6 max-w-sm">
                        <label for="review-settings-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Pilih Hotel untuk Dikelola</label>
                        <select id="review-settings-hotel-select" class="form-input w-full">
                            <option value="">-- Memuat hotel... --</option>
                        </select>
                    </div>

                    <!-- BARU: Tampilan Link Form -->
                    <div id="review-link-container" class="hidden my-6">
                        <label for="review-form-link" class="block text-sm font-medium text-slate-700 mb-1">Link Form Review Unik</label>
                        <div class="flex items-center gap-2">
                            <input type="text" id="review-form-link" readonly class="form-input w-full bg-slate-100 cursor-not-allowed">
                            <button type="button" id="copy-review-link-btn" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-2 px-4 rounded-lg transition" title="Salin Link">
                                <i class="fa-solid fa-copy"></i>
                            </button>
                        </div>
                        <p class="text-xs text-slate-500 mt-1">Gunakan link ini di website hotel atau bagikan langsung kepada tamu.</p>
                    </div>

                    <!-- Form Pengaturan (awalnya tersembunyi) -->
                    <form id="review-settings-form" class="hidden space-y-6">
                        <input type="hidden" id="review-settings-hotel-id" name="hotel_id">
                        <input type="hidden" id="review-settings-existing-logo-url" name="existing_logo_url">
                        <input type="hidden" id="review-settings-existing-promo-image-url" name="existing_promo_image_url">

                        <!-- Logo & Header -->
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="md:col-span-1">
                                <label class="block text-sm font-medium text-slate-700 mb-1">URL Logo Hotel</label>
                                <img id="review-settings-logo-preview" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTUwIiBoZWlnaHQ9IjE1MCIgZmlsbD0iI2U1ZTdlYiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzljYTNhZiIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+MTUweDE1MDwvdGV4dD48L3N2Zz4=" alt="Logo Preview" class="w-32 h-32 object-contain rounded-md border p-2 bg-slate-50 mb-2">
                                <input type="url" id="review-settings-logo-input" name="logo_url" class="form-input w-full" placeholder="https://example.com/logo.png">
                            </div>
                            <div class="md:col-span-2 space-y-4">
                                <div>
                                    <label for="review-settings-header" class="block text-sm font-medium text-slate-700 mb-1">Teks Header Utama</label>
                                    <input type="text" id="review-settings-header" name="header_text" class="form-input w-full">
                                </div>
                                <div>
                                    <label for="review-settings-subheader" class="block text-sm font-medium text-slate-700 mb-1">Teks Sub-Header</label>
                                    <textarea id="review-settings-subheader" name="subheader_text" rows="3" class="form-input w-full"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Pengaturan Promo -->
                        <div class="pt-6 border-t border-slate-200">
                            <div class="flex items-center justify-between">
                                <h4 class="font-semibold text-slate-800">Bagian Promo / Diskon</h4>
                                <label class="flex items-center cursor-pointer"><input type="checkbox" id="review-settings-promo-enabled" name="promo_enabled" value="true" class="form-checkbox h-5 w-5 text-blue-600 rounded"><span class="ml-2 text-sm text-slate-600">Aktifkan Promo</span></label>
                            </div>
                            <div id="review-settings-promo-fields" class="hidden mt-4 grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="md:col-span-1">
                                    <label class="block text-sm font-medium text-slate-700 mb-1">URL Gambar Promo</label>
                                    <img id="review-settings-promo-preview" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgZmlsbD0iI2U1ZTdlYiIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNiIgZmlsbD0iIzljYTNhZiIgZG9taW5hbnQtYmFzZWxpbmU9Im1pZGRsZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+MzAweDIwMDwvdGV4dD48L3N2Zz4=" alt="Promo Preview" class="w-full h-auto object-cover rounded-md border p-2 bg-slate-50 mb-2">
                                    <input type="url" id="review-settings-promo-input" name="promo_image_url" class="form-input w-full" placeholder="https://example.com/promo.jpg">
                                </div>
                                <div class="md:col-span-2 space-y-4">
                                    <div><label for="review-settings-promo-title" class="block text-sm font-medium text-slate-700 mb-1">Judul Promo</label><input type="text" id="review-settings-promo-title" name="promo_title" class="form-input w-full"></div>
                                    <div><label for="review-settings-promo-desc" class="block text-sm font-medium text-slate-700 mb-1">Deskripsi Promo</label><textarea id="review-settings-promo-desc" name="promo_description" rows="4" class="form-input w-full"></textarea></div>
                                </div>
                            </div>
                        </div>

                        <!-- Tombol Simpan -->
                        <div class="pt-6 border-t border-slate-200 flex justify-end">
                            <button type="submit" id="review-settings-save-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition"><i class="fa-solid fa-save mr-2"></i>Simpan Pengaturan</button>
                        </div>
                    </form>
                </div>
            </section>
            <section id="page-guest-review-replies" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Header dan Filter -->
                    <div class="mb-6 pb-4 border-b border-slate-200">
                        <h3 class="text-xl font-bold text-slate-800">Balas Ulasan Tamu</h3>
                        <p class="text-sm text-slate-500 mt-1">Lihat dan balas ulasan yang masuk dari tamu hotel Anda.</p>
                        
                        <!-- Filter -->
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mt-4 pt-4 border-t border-slate-100">
                            <div>
                                <label for="review-replies-hotel-filter" class="text-xs font-medium text-slate-600">Hotel</label>
                                <select id="review-replies-hotel-filter" class="form-input w-full mt-1 text-sm"></select>
                            </div>
                            <div>
                                <label for="review-replies-rating-filter" class="text-xs font-medium text-slate-600">Rating</label>
                                <select id="review-replies-rating-filter" class="form-input w-full mt-1 text-sm">
                                    <option value="all">Semua Rating</option>
                                    <option value="5"></option>
                                    <option value="4"></option>
                                    <option value="3"></option>
                                    <option value="2"></option>
                                    <option value="1"></option>
                                </select>
                            </div>
                            <div>
                                <label for="review-replies-status-filter" class="text-xs font-medium text-slate-600">Status</label>
                                <select id="review-replies-status-filter" class="form-input w-full mt-1 text-sm">
                                    <option value="all">Semua</option>
                                    <option value="pending" selected>Pending</option>
                                    <option value="approved">Approved</option>
                                    <option value="rejected">Rejected</option>
                                </select>
                            </div>
                            <div class="col-span-2 lg:col-span-2">
                                <label class="text-xs font-medium text-slate-600">Rentang Tanggal</label>
                                <div class="flex items-center gap-2 mt-1">
                                    <input type="date" id="review-replies-start-date" class="form-input w-full text-sm">
                                    <span class="text-slate-500">-</span>
                                    <input type="date" id="review-replies-end-date" class="form-input w-full text-sm">
                                </div>
                            </div>
                            <div class="col-span-2 md:col-span-3 lg:col-span-5 flex justify-end items-center gap-3 pt-2">
                                <button id="review-replies-filter-reset-btn" class="text-sm text-slate-600 hover:text-slate-800">Reset</button>
                                <button id="review-replies-filter-apply-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                    <i class="fa-solid fa-filter mr-2"></i>Terapkan
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Daftar Ulasan -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3">Tamu</th>
                                    <th scope="col" class="px-6 py-3">Hotel</th>
                                    <th scope="col" class="px-6 py-3">Check-in</th>
                                    <th scope="col" class="px-6 py-3">Nomor Voucher</th>
                                    <th scope="col" class="px-6 py-3">Tgl. Penggunaan</th>
                                    <th scope="col" class="px-6 py-3 text-center">Rating</th>
                                    <th scope="col" class="px-6 py-3">Komentar</th>
                                    <th scope="col" class="px-6 py-3 text-center">Foto</th>
                                    <th scope="col" class="px-6 py-3">Tanggal</th>
                                    <th scope="col" class="px-6 py-3 text-center">Status</th>
                                    <th scope="col" class="px-6 py-3 text-center">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="review-replies-list" data-id="review-replies-list-body"></tbody>
                        </table>
                    </div>

                    <!-- Paginasi -->
                    <div class="flex items-center justify-between border-t border-slate-200 bg-white px-4 py-3 sm:px-6 mt-6 rounded-b-lg">
                        <div id="review-replies-pagination-info" class="text-sm text-slate-700"></div>
                        <div id="review-replies-pagination-controls"></div>
                    </div>
                </div>
            </section>
            <section id="page-guest-review-vouchers" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Header dan Filter -->
                    <div class="mb-6 pb-4 border-b border-slate-200">
                        <h3 class="text-xl font-bold text-slate-800">Verifikasi Penggunaan Voucher</h3>
                        <p class="text-sm text-slate-500 mt-1">Kelola dan verifikasi voucher yang digunakan oleh tamu.</p>
                        
                        <!-- Filter -->
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mt-4 pt-4 border-t border-slate-100">
                            <div>
                                <label for="voucher-use-hotel-filter" class="text-xs font-medium text-slate-600">Hotel</label>
                                <select id="voucher-use-hotel-filter" class="form-input w-full mt-1 text-sm"></select>
                            </div>
                            <div>
                                <label for="voucher-use-status-filter" class="text-xs font-medium text-slate-600">Status Voucher</label>
                                <select id="voucher-use-status-filter" class="form-input w-full mt-1 text-sm">
                                    <option value="all">Semua</option>
                                    <option value="available" selected>Tersedia</option>
                                    <option value="used">Sudah Digunakan</option>
                                </select>
                            </div>
                            <div class="col-span-2 lg:col-span-3">
                                <label for="voucher-use-search-input" class="text-xs font-medium text-slate-600">Cari (Nama Tamu / No. Voucher)</label>
                                <input type="text" id="voucher-use-search-input" class="form-input w-full mt-1 text-sm" placeholder="Ketik untuk mencari...">
                            </div>
                        </div>
                    </div>
            
                    <!-- Daftar Voucher -->
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr><th scope="col" class="px-6 py-3">Tamu</th><th scope="col" class="px-6 py-3">Hotel</th><th scope="col" class="px-6 py-3">Nomor Voucher</th><th scope="col" class="px-6 py-3">Tanggal Ulasan</th><th scope="col" class="px-6 py-3 text-center">Status</th><th scope="col" class="px-6 py-3 text-center">Aksi</th></tr>
                            </thead>
                            <tbody id="voucher-use-list-body"></tbody>
                        </table>
                    </div>
            
                    <!-- Paginasi -->
                    <div class="flex items-center justify-between border-t border-slate-200 bg-white px-4 py-3 sm:px-6 mt-6 rounded-b-lg"><div id="voucher-use-pagination-info" class="text-sm text-slate-700"></div><div id="voucher-use-pagination-controls"></div></div>
                </div>
            </section>

            <!-- MODAL UNTUK BALAS ULASAN -->
            <div id="reply-review-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
                <div class="max-w-2xl w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col max-h-[90vh]">
                    <!-- Header -->
                    <div class="flex justify-between items-center p-5 border-b border-slate-200">
                        <h3 class="text-lg font-bold text-slate-800">Balas Ulasan Tamu</h3>
                        <button onclick="closeReplyModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
                    </div>
                    <!-- Body -->
                    <div class="p-6 space-y-4 overflow-y-auto">
                        <!-- Detail Ulasan Asli -->
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <div class="flex justify-between items-center">
                                <p class="font-semibold text-slate-800" id="modal-review-guest-name">Nama Tamu</p>
                                <p class="text-amber-500 font-bold" id="modal-review-rating"></p>
                            </div>
                            <p class="text-xs text-slate-500" id="modal-review-date">Tanggal Ulasan</p>
                            <p class="text-xs text-slate-500 mt-1">No. Voucher: <span id="modal-review-voucher-number" class="font-medium text-slate-700"></span></p>
                            <p class="text-xs text-slate-500 mt-1">Email Tamu: <span id="modal-guest-email" class="font-medium text-slate-700"></span></p>
                            <blockquote class="mt-2 text-slate-700 border-l-4 border-slate-300 pl-4 italic" id="modal-review-comment">
                                Isi komentar tamu akan ditampilkan di sini.
                            </blockquote>
                        </div>
                        <!-- Form Balasan -->
                        <form id="reply-review-form" class="space-y-2">
                            <input type="hidden" id="modal-review-id" name="reviewId">
                            <label for="modal-reply-text" class="block text-sm font-medium text-slate-700">Tulis Balasan Anda</label>
                            <textarea id="modal-reply-text" name="reply_text" rows="5" class="form-input w-full" placeholder="Terima kasih atas ulasan Anda..." required></textarea>
                            <!-- BARU: BCC Email Input -->
                            <div class="mt-4">
                                <label for="modal-bcc-email" class="block text-sm font-medium text-slate-700">BCC (Opsional)</label>
                                <div class="mt-1">
                                    <input type="email" name="bcc_email" id="modal-bcc-email" class="form-input w-full" placeholder="Kirim salinan balasan ke email ini...">
                                    <p class="mt-1 text-xs text-slate-500">Email ini akan menerima salinan balasan, tetapi tidak akan terlihat oleh tamu.</p>
                                </div>
                            </div>
                            <div class="pt-2 flex justify-end">
                                <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Kirim Balasan</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- MODAL VERIFIKASI VOUCHER -->
            <div id="verify-voucher-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
                <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
                    <!-- Header -->
                    <div class="flex justify-between items-center p-5 border-b border-slate-200">
                        <h3 class="text-lg font-bold text-slate-800">Verifikasi Penggunaan Voucher</h3>
                        <button onclick="closeVerifyVoucherModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
                    </div>
                    <!-- Body -->
                    <form id="verify-voucher-form" class="p-6 space-y-4">
                        <input type="hidden" id="modal-voucher-review-id">
                        
                        <div class="bg-slate-50 p-4 rounded-lg border border-slate-200">
                            <p class="text-sm">Voucher: <strong id="modal-voucher-code" class="text-blue-600"></strong></p>
                            <p class="text-sm">Atas Nama: <strong id="modal-voucher-guest-name"></strong></p>
                        </div>
            
                        <div>
                            <label for="modal-voucher-use-date" class="block text-sm font-medium text-slate-700 mb-1">Tanggal Penggunaan <span class="text-red-500">*</span></label>
                            <input type="date" id="modal-voucher-use-date" name="use_date" class="form-input w-full" required>
                        </div>
                        <div>
                            <label for="modal-voucher-guest-name-used" class="block text-sm font-medium text-slate-700 mb-1">Nama Tamu (yang menggunakan) <span class="text-red-500">*</span></label>
                            <input type="text" id="modal-voucher-guest-name-used" name="guest_name_used" class="form-input w-full" placeholder="Nama tamu yang check-in" required>
                        </div>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                            <div><label for="modal-voucher-room-number" class="block text-sm font-medium text-slate-700 mb-1">Nomor Kamar <span class="text-red-500">*</span></label><input type="text" id="modal-voucher-room-number" name="room_number" class="form-input w-full" placeholder="Contoh: 101" required></div>
                            <div><label for="modal-voucher-folio-number" class="block text-sm font-medium text-slate-700 mb-1">Nomor Folio <span class="text-red-500">*</span></label><input type="text" id="modal-voucher-folio-number" name="folio_number" class="form-input w-full" placeholder="Nomor folio dari PMS" required></div>
                        </div>
                        
                        <!-- Footer -->
                        <div class="pt-4 flex justify-end"><button type="submit" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition"><i class="fa-solid fa-check-circle mr-2"></i>Verifikasi & Gunakan Voucher</button></div>
                    </form>
                </div>
            </div>


            <!-- Bagian Manajemen Hotel (awalnya tersembunyi) -->
            <div id="hotel-management-section" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold">Daftar Hotel</h3>
                    <button onclick="openAddHotelModal()" class="bg-green-600 hover:bg-green-700 text-white text-sm px-4 py-2 rounded-md shadow transition">
                        <i class="fa-solid fa-plus mr-1"></i> Tambah Hotel
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-500">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                            <tr>
                                <th scope="col" class="px-6 py-3">Nama Hotel</th>
                                <th scope="col" class="px-6 py-3">Brand</th>
                                <th scope="col" class="px-6 py-3">Kota</th>
                                <th scope="col" class="px-6 py-3">Alamat</th>
                                <th scope="col" class="px-6 py-3 text-center">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="hotel-table-body">
                            <!-- Data hotel akan dimuat di sini oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- BARU: Bagian Kelola Checklist Audit (awalnya tersembunyi) -->
            <div id="audit-checklists-management-section" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 pb-4 border-b border-slate-200">
                    <div>
                        <h3 class="text-xl font-bold">Kelola Checklist Audit</h3>
                        <p class="text-sm text-slate-500">Buat dan atur item yang akan diperiksa saat audit.</p>
                    </div>
                    <div class="flex items-center gap-3 mt-3 md:mt-0">
                        <button id="add-audit-category-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                            <i class="fa-solid fa-plus mr-2"></i>Tambah Kategori
                        </button>
                        <button onclick="window.location.hash = '#settings'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                            <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                        </button>
                    </div>
                </div>
                <!-- Kontainer untuk daftar checklist -->
                <div id="audit-checklist-container" class="space-y-4">
                    <!-- Konten akan diisi oleh JavaScript -->
                </div>
            </div>

            <!-- BARU: Bagian Kelola Tipe Inspeksi (awalnya tersembunyi) -->
            <div id="inspection-types-management-section" class="hidden bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                <!-- Header -->
                <div class="flex justify-between items-center mb-6 pb-4 border-b border-slate-200">
                    <div>
                        <h3 class="text-xl font-bold">Kelola Tipe Inspeksi</h3>
                        <p class="text-sm text-slate-500">Buat dan atur template untuk berbagai jenis inspeksi.</p>
                    </div>
                    <button onclick="window.location.hash = '#settings'" class="bg-slate-100 hover:bg-slate-200 text-slate-600 text-sm px-4 py-2 rounded-md shadow-sm transition flex-shrink-0">
                        <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                    </button>
                </div>

                <!-- Main Content Grid -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Kolom Kiri: Daftar Tipe Inspeksi -->
                    <div class="md:col-span-1">
                        <div class="flex justify-between items-center mb-3">
                            <h4 class="font-semibold">Daftar Tipe</h4>
                            <button class="text-sm bg-blue-500 hover:bg-blue-600 text-white font-bold py-1 px-3 rounded-md transition">
                                <i class="fa-solid fa-plus text-xs"></i> Baru
                            </button>
                        </div>
                        <ul class="space-y-2" id="inspection-type-list">
                            <!-- Contoh Item (Aktif) -->
                            <li><a href="#" class="block p-3 rounded-lg bg-blue-100 border border-blue-200 text-blue-800 font-semibold"><div class="flex justify-between items-center"><span>Inspeksi Kamar</span><span class="text-xs font-normal bg-blue-200 text-blue-800 px-2 py-0.5 rounded-full">15 Item</span></div></a></li>
                            <!-- Contoh Item Lainnya -->
                            <li><a href="#" class="block p-3 rounded-lg hover:bg-slate-100 border border-transparent"><div class="flex justify-between items-center"><span>Inspeksi Area Publik</span><span class="text-xs text-slate-500">8 Item</span></div></a></li>
                            <li><a href="#" class="block p-3 rounded-lg hover:bg-slate-100 border border-transparent"><div class="flex justify-between items-center"><span>Inspeksi Dapur</span><span class="text-xs text-slate-500">22 Item</span></div></a></li>
                        </ul>
                    </div>

                    <!-- Kolom Kanan: Detail & Item Checklist -->
                    <div class="md:col-span-2">
                        <div id="inspection-item-header" class="hidden">
                            <div class="flex justify-between items-center mb-3">
                                <h4 class="font-semibold">Item Checklist untuk: <span id="selected-inspection-type-name" class="text-blue-700"></span></h4>
                                <button onclick="openAddInspectionItemModal()" class="text-sm bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-3 rounded-md transition">
                                <i class="fa-solid fa-plus text-xs"></i> Tambah Item
                                </button>
                            </div>
                            <div id="inspection-item-list-container" class="bg-slate-50 p-4 rounded-lg border border-slate-200 min-h-[300px] space-y-3"></div>
                        </div>
                        <div id="inspection-item-placeholder" class="text-center text-slate-500 py-10"><i class="fa-solid fa-arrow-left text-3xl mb-3"></i><p>Pilih tipe inspeksi di sebelah kiri untuk melihat itemnya.</p></div>
                    </div>
                </div>
            </div>

            <!-- BARU: 17. TRIAL BALANCE -->
            <section id="page-trial-balance" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h3 class="text-xl font-bold">Trial Balance</h3>
                    <p class="text-slate-500">Halaman ini sedang dalam pengembangan.</p>
                </div>
            </section>

            <!-- BARU: HALAMAN AGENDA AUDIT -->
            <section id="page-agenda-audit" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <!-- Header -->
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 pb-4 border-b border-slate-200">
                        <h3 class="text-xl font-bold text-slate-800">Agenda Kunjungan Audit</h3>
                        <button onclick="openAddEditAgendaModal()" class="mt-3 md:mt-0 w-full md:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                            <i class="fa-solid fa-plus mr-2"></i>Tambah Agenda
                        </button>
                    </div>

                    <!-- Tabel Agenda -->
                    <div class="overflow-x-auto">
                        <table id="audit-agenda-table" class="w-full text-sm text-left text-slate-500">
                            <thead class="text-xs text-slate-700 uppercase bg-slate-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3">Tanggal Kunjungan</th>
                                    <th scope="col" class="px-6 py-3">Hotel</th>
                                    <th scope="col" class="px-6 py-3">Auditor</th>
                                    <th scope="col" class="px-6 py-3">Status</th>
                                    <th scope="col" class="px-6 py-3">Keterangan</th>
                                    <th scope="col" class="px-6 py-3 text-center">Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="audit-agenda-table-body">
                                <tr><td colspan="6" class="text-center p-8 text-slate-500"><i class="fa-solid fa-circle-notch fa-spin mr-2"></i> Memuat data agenda...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- BARU: HALAMAN KALENDER AUDIT -->
            <section id="page-audit-calendar" class="page-content-wrapper hidden fade-in">
                 <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4">
                        <h3 class="text-xl font-bold mb-3 md:mb-0">Kalender Agenda Audit</h3>
                        <div class="flex flex-col sm:flex-row items-center gap-4 w-full sm:w-auto">
                            <!-- BARU: Filter Hotel -->
                            <div class="w-full sm:w-auto">
                                <label for="audit-calendar-hotel-filter" class="sr-only">Filter Hotel</label>
                                <select id="audit-calendar-hotel-filter" class="form-input text-sm w-full">
                                    <option value="all">Semua Hotel</option>
                                </select>
                            </div>
                        <!-- BARU: Filter Status -->
                        <div id="audit-calendar-status-filter" class="inline-flex rounded-md shadow-sm" role="group">
                            <button type="button" data-status="all" class="audit-status-filter-btn active-filter-btn rounded-l-lg border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 focus:z-10 focus:ring-2 focus:ring-blue-500">
                                Semua
                            </button>
                            <button type="button" data-status="planned" class="audit-status-filter-btn border-t border-b border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 focus:z-10 focus:ring-2 focus:ring-blue-500">
                                Planned
                            </button>
                            <button type="button" data-status="on_progress" class="audit-status-filter-btn border-t border-b border-l border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 focus:z-10 focus:ring-2 focus:ring-blue-500">
                                On Progress
                            </button>
                            <button type="button" data-status="completed" class="audit-status-filter-btn border-t border-b border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 focus:z-10 focus:ring-2 focus:ring-blue-500">
                                Completed
                            </button>
                            <button type="button" data-status="cancelled" class="audit-status-filter-btn rounded-r-md border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-900 hover:bg-slate-50 focus:z-10 focus:ring-2 focus:ring-blue-500">
                                Cancelled
                            </button>
                        </div>
                        </div>
                    </div>
                    <!-- Container untuk FullCalendar -->
                    <div id="calendar"></div>
                </div>
            </section>

            <!-- BARU: HALAMAN LAPORAN AUDIT -->
            <section id="page-audit-report" class="page-content-wrapper hidden fade-in">
                <div id="audit-report-content" class="bg-white p-6 md:p-8 rounded-xl shadow-sm border border-slate-100">
                    <!-- Header Laporan -->
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 pb-6 border-b border-slate-200 print:border-0">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">Laporan Hasil Audit</h2>
                            <div class="mt-2 text-sm text-slate-500 space-y-1">
                                <p><strong>Hotel:</strong> <span id="report-hotel-name">Memuat...</span></p>
                                <p><strong>Tanggal Audit:</strong> <span id="report-audit-date">Memuat...</span></p>
                                <p><strong>Auditor:</strong> <span id="report-auditor-name">Memuat...</span></p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3 mt-4 md:mt-0 print:hidden">
                            <button onclick="window.history.back()" class="bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold py-2 px-4 rounded-lg transition">
                                <i class="fa-solid fa-arrow-left mr-2"></i> Kembali
                            </button>
                            <button onclick="window.print()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                                <i class="fa-solid fa-print mr-2"></i> Cetak Laporan
                            </button>
                        </div>
                    </div>

                    <!-- Ringkasan Skor -->
                    <div class="mb-8">
                        <h3 class="text-lg font-bold text-slate-700 mb-4">Ringkasan</h3>
                        <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
                            <div class="bg-blue-50 border border-blue-200 p-4 rounded-lg text-center"><p class="text-sm font-medium text-blue-700">Skor Akhir</p><p id="report-summary-score" class="text-3xl font-bold text-blue-800">-%</p></div>
                            <div class="bg-slate-50 border p-4 rounded-lg text-center"><p class="text-sm font-medium text-slate-600">Total Item</p><p id="report-summary-total" class="text-3xl font-bold text-slate-800">-</p></div>
                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg text-center"><p class="text-sm font-medium text-green-700">Pass</p><p id="report-summary-pass" class="text-3xl font-bold text-green-800">-</p></div>
                            <div class="bg-red-50 border border-red-200 p-4 rounded-lg text-center"><p class="text-sm font-medium text-red-700">Fail</p><p id="report-summary-fail" class="text-3xl font-bold text-red-800">-</p></div>
                            <div class="bg-yellow-50 border border-yellow-200 p-4 rounded-lg text-center"><p class="text-sm font-medium text-yellow-700">N/A</p><p id="report-summary-na" class="text-3xl font-bold text-yellow-800">-</p></div>
                        </div>
                    </div>

                    <!-- Detail Checklist -->
                    <div id="report-checklist-details" class="space-y-6">
                        <div class="text-center p-8"><i class="fa-solid fa-circle-notch fa-spin text-2xl text-blue-500"></i><p class="mt-2 text-slate-500">Memuat detail laporan...</p></div>
                    </div>

                    <!-- BARU: Bagian Tanda Tangan -->
                    <div class="mt-16 pt-8 border-t border-slate-200 print:mt-24">
                        <div class="flex justify-around items-start text-center text-sm">
                            <!-- Kolom Auditor -->
                            <div class="w-1/3">
                                <p class="mb-20">Dibuat oleh,</p>
                                <div class="border-t border-slate-400 pt-2 mx-auto max-w-[200px]">
                                    <p class="font-semibold" id="signature-auditor-name">Memuat...</p>
                                    <p class="text-xs text-slate-500">Auditor</p>
                                </div>
                            </div>
                            <!-- Kolom Staff Hotel -->
                            <div class="w-1/3">
                                <p class="mb-20">Disetujui oleh,</p>
                                <div class="border-t border-slate-400 pt-2 mx-auto max-w-[200px]">
                                    <p class="font-semibold">(..............................)</p>
                                    <p class="text-xs text-slate-500">Perwakilan Hotel</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- CSS Khusus untuk Print -->
                <style> @media print { body * { visibility: hidden; } #audit-report-content, #audit-report-content * { visibility: visible; } #audit-report-content { position: absolute; left: 0; top: 0; width: 100%; margin: 0; padding: 0; border: 0; box-shadow: none; } .print\:hidden { display: none; } .print\:border-0 { border: 0; } .page-break-before { page-break-before: always; } } </style>
            </section>

            <!-- BARU: 18. GOOGLE DRIVE -->
            <section id="page-google-drive" class="page-content-wrapper hidden fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h3 class="text-xl font-bold">Google Drive</h3>
                    <p class="text-slate-500">Halaman ini sedang dalam pengembangan.</p>
                </div>
            </section>
        </div>
    </main>

    <!-- Mobile Sidebar Overlay -->
    <div id="sidebar-overlay" class="fixed inset-0 bg-black/50 z-20 hidden" onclick="toggleSidebar()"></div>

    <!-- ADD HOTEL MODAL -->
    <div id="add-hotel-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Tambah Hotel Baru</h3>
                <button onclick="closeAddHotelModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="add-hotel-form" class="p-6 space-y-4 overflow-y-auto">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="md:col-span-2"><label for="hotel-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Hotel <span class="text-red-500">*</span></label><input type="text" id="hotel-name" name="name" class="form-input" placeholder="Contoh: Grand Hotel Jakarta" required></div>
                    <div><label for="hotel-brand" class="block text-sm font-medium text-slate-700 mb-1">Brand</label><input type="text" id="hotel-brand" name="brand" class="form-input" placeholder="Contoh: Accor"></div>
                    <div><label for="hotel-city" class="block text-sm font-medium text-slate-700 mb-1">Kota</label><input type="text" id="hotel-city" name="city" class="form-input" placeholder="Contoh: Jakarta"></div>
                </div>
                <div><label for="hotel-address" class="block text-sm font-medium text-slate-700 mb-1">Alamat</label><textarea id="hotel-address" name="address" class="form-input" rows="3" placeholder="Jl. Jenderal Sudirman Kav. 1, Jakarta"></textarea></div>
                <div id="add-hotel-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3"><button type="submit" id="add-hotel-submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Hotel</button></div>
            </form>
        </div>
    </div>

    <!-- BARU: MODAL UNTUK MEMULAI INSPEKSI -->
    <div id="start-inspection-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Mulai Inspeksi Baru</h3>
                <button onclick="closeStartInspectionModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="start-inspection-form" class="p-6 space-y-4">
                <div>
                    <label for="start-inspection-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Pilih Hotel</label>
                    <select id="start-inspection-hotel-select" name="hotelId" class="form-input w-full" required>
                        <!-- Opsi hotel akan diisi oleh JavaScript -->
                    </select>
                </div>
                <div>
                    <label for="start-inspection-template-select" class="block text-sm font-medium text-slate-700 mb-1">Tipe Inspeksi</label>
                    <select id="start-inspection-template-select" name="template" class="form-input w-full" required>
                        <option value="">-- Pilih Tipe --</option>
                    </select>
                </div>
                <div>
                    <label for="inspector-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Inspektor</label>
                    <input type="text" id="inspector-name" name="inspectorName" class="form-input w-full" placeholder="Nama lengkap Anda" required>
                </div>
                <div class="pt-4 flex justify-end">
                    <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition shadow-lg shadow-blue-500/20">
                        <i class="fa-solid fa-play mr-2"></i>Mulai Inspeksi
                    </button>
                </div>
            </form>
        </div>
    </div>
    <!-- EDIT HOTEL MODAL -->
    <div id="edit-hotel-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Edit Data Hotel</h3>
                <button onclick="closeEditHotelModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="edit-hotel-form" class="p-6 space-y-4 overflow-y-auto">
                <input type="hidden" id="edit-hotel-id" name="hotelId">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="md:col-span-2"><label for="edit-hotel-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Hotel <span class="text-red-500">*</span></label><input type="text" id="edit-hotel-name" name="name" class="form-input" placeholder="Contoh: Grand Hotel Jakarta" required></div>
                    <div><label for="edit-hotel-brand" class="block text-sm font-medium text-slate-700 mb-1">Brand</label><input type="text" id="edit-hotel-brand" name="brand" class="form-input" placeholder="Contoh: Accor"></div>
                    <div><label for="edit-hotel-city" class="block text-sm font-medium text-slate-700 mb-1">Kota</label><input type="text" id="edit-hotel-city" name="city" class="form-input" placeholder="Contoh: Jakarta"></div>
                </div>
                <div><label for="edit-hotel-address" class="block text-sm font-medium text-slate-700 mb-1">Alamat</label><textarea id="edit-hotel-address" name="address" class="form-input" rows="3" placeholder="Jl. Jenderal Sudirman Kav. 1, Jakarta"></textarea></div>
                <div id="edit-hotel-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3"><button type="submit" id="edit-hotel-submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Perubahan</button></div>
            </form>
        </div>
    </div>

    <!-- ADD USER MODAL -->
    <div id="add-user-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <!-- Header -->
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Tambah Pengguna Baru</h3>
                <button onclick="closeAddUserModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition">
                    <i class="fa-solid fa-xmark text-slate-600"></i>
                </button>
            </div>
            <!-- Form -->
            <form id="add-user-form" class="p-6 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="user-fullname" class="block text-sm font-medium text-slate-700 mb-1">Nama Lengkap</label>
                        <input type="text" id="user-fullname" name="fullName" class="form-input" placeholder="John Doe">
                    </div>
                    <div>
                        <label for="user-username" class="block text-sm font-medium text-slate-700 mb-1">Username <span class="text-red-500">*</span></label>
                        <input type="text" id="user-username" name="username" class="form-input" placeholder="johndoe" required>
                    </div>
                </div>
                <div>
                    <label for="user-email" class="block text-sm font-medium text-slate-700 mb-1">Email <span class="text-red-500">*</span></label>
                    <input type="email" id="user-email" name="email" class="form-input" placeholder="john.doe@example.com" required>
                </div>
                <div>
                    <label for="user-password" class="block text-sm font-medium text-slate-700 mb-1">Password <span class="text-red-500">*</span></label>
                    <input type="password" id="user-password" name="password" class="form-input" placeholder="" required>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="user-role" class="block text-sm font-medium text-slate-700 mb-1">Role <span class="text-red-500">*</span></label>
                        <!-- Opsi akan diisi oleh JavaScript -->
                        <select id="user-role" name="role" class="form-input" required></select>
                    </div>
                    <div id="hotel-id-field" class="hidden">
                        <label for="user-add-hotel-filter-btn" class="block text-sm font-medium text-slate-700 mb-1">Hotel</label>
                        <!-- Komponen Checklist Hotel Baru -->
                        <div class="relative">
                            <button type="button" id="user-add-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                                <span id="user-add-hotel-filter-label" class="truncate pr-2">-- Pilih Hotel --</span>
                                <i class="fa-solid fa-chevron-down text-slate-400"></i>
                            </button>
                            <div id="user-add-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full bg-white rounded-md shadow-lg border border-slate-200 max-h-60 overflow-y-auto">
                                <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                    <input type="text" id="user-add-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                    <label class="flex items-center space-x-2 cursor-pointer p-1">
                                        <input type="checkbox" id="user-add-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                        <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                    </label>
                                </div>
                                <div id="user-add-hotel-checklist-container" class="p-2 space-y-2">
                                    <!-- Checklist hotel akan diisi oleh JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="add-user-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <!-- Footer -->
                <div class="pt-4 flex justify-end gap-3">
                    <button type="submit" id="add-user-submit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Pengguna</button>
                </div>
            </form>
        </div>
    </div>

    <!-- EDIT USER MODAL -->
    <div id="edit-user-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <!-- Header -->
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Edit Data Pengguna</h3>
                <button onclick="closeEditUserModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition">
                    <i class="fa-solid fa-xmark text-slate-600"></i>
                </button>
            </div>
            <!-- Form -->
            <form id="edit-user-form" class="p-6 space-y-4">
                <input type="hidden" id="edit-user-id" name="userId">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="edit-user-fullname" class="block text-sm font-medium text-slate-700 mb-1">Nama Lengkap</label>
                        <input type="text" id="edit-user-fullname" name="fullName" class="form-input" placeholder="John Doe">
                    </div>
                    <div>
                        <label for="edit-user-email" class="block text-sm font-medium text-slate-700 mb-1">Email <span class="text-red-500">*</span></label>
                        <input type="email" id="edit-user-email" name="email" class="form-input bg-slate-100 cursor-not-allowed" placeholder="john.doe@example.com" required readonly>
                    </div>
                </div>
                <div>
                    <label for="edit-user-password" class="block text-sm font-medium text-slate-700 mb-1">Password Baru</label>
                    <input type="password" id="edit-user-password" name="password" class="form-input" placeholder="Kosongkan jika tidak ingin diubah">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="edit-user-role" class="block text-sm font-medium text-slate-700 mb-1">Role <span class="text-red-500">*</span></label>
                        <!-- Opsi akan diisi oleh JavaScript -->
                        <select id="edit-user-role" name="role" class="form-input" required></select>
                    </div>
                    <!-- BARU: Checklist Hotel untuk Edit Pengguna -->
                    <div id="edit-hotel-id-field" class="hidden">
                        <label for="user-edit-hotel-filter-btn" class="block text-sm font-medium text-slate-700 mb-1">Akses Hotel</label>
                        <div class="relative">
                            <button type="button" id="user-edit-hotel-filter-btn" class="form-input w-full text-left flex justify-between items-center">
                                <span id="user-edit-hotel-filter-label" class="truncate pr-2">-- Pilih Hotel --</span>
                                <i class="fa-solid fa-chevron-down text-slate-400"></i>
                            </button>
                            <div id="user-edit-hotel-filter-dropdown" class="hidden absolute z-20 mt-1 w-full bg-white rounded-md shadow-lg border border-slate-200 max-h-60 overflow-y-auto">
                                <div class="p-2 sticky top-0 bg-white border-b border-slate-100">
                                    <input type="text" id="user-edit-hotel-filter-search" placeholder="Cari hotel..." class="form-input w-full text-sm mb-2">
                                    <label class="flex items-center space-x-2 cursor-pointer p-1">
                                        <input type="checkbox" id="user-edit-hotel-filter-select-all" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500">
                                        <span class="text-xs text-slate-600 font-medium">Pilih Semua</span>
                                    </label>
                                </div>
                                <div id="user-edit-hotel-checklist-container" class="p-2 space-y-2"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="edit-user-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <!-- Footer -->
                <div class="pt-4 flex justify-end gap-3">
                    <button type="submit" id="edit-user-submit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Perubahan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- UPLOAD PDF MODAL -->
    <div id="upload-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-xl w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col max-h-[90vh]">
            <!-- Close Button -->
            <button onclick="closeUploadModal()" class="absolute top-3 right-3 w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition">
                <i class="fa-solid fa-xmark text-slate-600"></i>
            </button>

            <!-- Scrollable Content Area -->
            <div class="overflow-y-auto p-8 text-center">
                <div class="w-20 h-20 bg-blue-50 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fa-solid fa-layer-group text-3xl"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800 mb-2">Upload Multiple PDF</h3>
                <p class="text-slate-500 text-sm mb-6">Pilih beberapa file. Sistem akan menggabungkannya menjadi 1 Flipbook.</p>

                <!-- Title Input -->
                <div class="text-left mb-4">
                    <label for="book-title-input" class="block text-sm font-medium text-slate-700 mb-1">Judul Buku</label>
                    <input type="text" id="book-title-input" placeholder="Contoh: Laporan Keuangan Q1 2024" class="w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                </div>

                <!-- BARU: Pilihan Hotel -->
                <div class="text-left mb-4">
                    <label for="book-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Tugaskan ke Hotel (Opsional)</label>
                    <select id="book-hotel-select" class="w-full px-3 py-2 border border-slate-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"></select>
                </div>
                
                <label class="block w-full border-2 border-dashed border-slate-300 rounded-lg p-8 hover:bg-slate-50 cursor-pointer transition mb-4 relative">
                    <input type="file" id="pdf-input" class="hidden" accept=".pdf" multiple onchange="handleFileSelect(this)">
                    <span id="upload-label" class="text-slate-600 font-medium">Klik untuk memilih file PDF</span>
                </label>

                <div id="file-list" class="text-left text-sm text-slate-600 mb-4 space-y-2 max-h-40 overflow-y-auto pr-2"></div>
            </div>
            <!-- Modal Footer (Not scrollable) -->
            <div class="p-6 pt-4 border-t border-slate-200 bg-slate-50 rounded-b-xl flex-shrink-0">
                <button id="btn-convert" onclick="processUploadQueue()" disabled class="w-full bg-slate-300 text-white font-bold py-3 rounded-lg cursor-not-allowed transition">
                    <i class="fa-solid fa-object-group mr-2"></i> Gabung & Buat Buku
                </button>
            </div>
        </div>
    </div>

    <!-- ADD/EDIT SLIDE MODAL -->
    <div id="add-edit-slide-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 id="add-edit-slide-modal-title" class="text-lg font-bold text-slate-800">Tambah Slide Baru</h3>
                <button onclick="closeAddEditSlideModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="add-edit-slide-form" class="p-6 space-y-4 overflow-y-auto">
                <input type="hidden" id="slide-id" name="slideId">
                <div>
                    <label for="slide-title" class="block text-sm font-medium text-slate-700 mb-1">Judul Slide <span class="text-red-500">*</span></label>
                    <input type="text" id="slide-title" name="title" class="form-input" placeholder="Contoh: Laporan Q4 2024" required>
                </div>
                <div>
                    <label for="slide-link" class="block text-sm font-medium text-slate-700 mb-1">Link Google Slide <span class="text-red-500">*</span></label>
                    <input type="url" id="slide-link" name="link" class="form-input" placeholder="Contoh: https://docs.google.com/presentation/d/..." required>
                </div>
                <div>
                    <label for="slide-thumbnail" class="block text-sm font-medium text-slate-700 mb-1">URL Thumbnail (Opsional)</label>
                    <input type="text" id="slide-thumbnail" name="thumbnail_url" class="form-input" placeholder="Contoh: https://example.com/foto.jpg">
                </div>
                <div>
                    <label for="slide-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel <span class="text-red-500">*</span></label>
                    <select id="slide-hotel-select" name="hotelId" class="form-input">
                        <option value="">Pilih Hotel</option>
                        <!-- Options will be loaded by JavaScript -->
                    </select>
                </div>
                <div id="add-edit-slide-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3">
                    <button type="submit" id="add-edit-slide-submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Slide</button>
                </div>
            </form>
        </div>
    </div>

    <!-- BARU: ADD TRIAL BALANCE MODAL -->
    <div id="add-trial-balance-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 id="add-trial-balance-modal-title" class="text-lg font-bold text-slate-800">Tambah Trial Balance Baru</h3>
                <button onclick="closeAddTrialBalanceModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="add-trial-balance-form" class="p-6 space-y-4 overflow-y-auto">
                <input type="hidden" id="trial-balance-id" name="trialBalanceId">
                <div>
                    <label for="trial-balance-title" class="block text-sm font-medium text-slate-700 mb-1">Judul <span class="text-red-500">*</span></label>
                    <input type="text" id="trial-balance-title" name="title" class="form-input" placeholder="Contoh: Trial Balance Januari 2024" required>
                </div>
                <div>
                    <label for="trial-balance-link" class="flex items-center text-sm font-medium text-slate-700 mb-1"><i class="fa-solid fa-file-excel text-green-600 mr-2"></i>Link Google Sheet <span class="text-red-500 ml-1">*</span></label>
                    <input type="url" id="trial-balance-link" name="link" class="form-input" placeholder="https://docs.google.com/spreadsheets/d/..." required>
                </div>
                <div>
                    <label for="trial-balance-drive-folder-link" class="flex items-center text-sm font-medium text-slate-700 mb-1"><i class="fa-brands fa-google-drive text-slate-500 mr-2"></i>Link Google Drive Folder (Opsional)</label>
                    <input type="url" id="trial-balance-drive-folder-link" name="drive_folder_link" class="form-input" placeholder="https://drive.google.com/drive/folders/...">
                </div>
                <div>
                    <label for="trial-balance-thumbnail" class="flex items-center text-sm font-medium text-slate-700 mb-1"><i class="fa-solid fa-image text-slate-500 mr-2"></i>Link Foto Thumbnail (Opsional)</label>
                    <input type="url" id="trial-balance-thumbnail" name="thumbnail_url" class="form-input" placeholder="https://example.com/image.jpg">
                </div>
                <div>
                    <label for="trial-balance-status" class="block text-sm font-medium text-slate-700 mb-1">Status Audit <span class="text-red-500">*</span></label>
                    <select id="trial-balance-status" name="status" class="form-input" required>
                        <option value="not_audited">Belum Diaudit</option>
                        <option value="in_audit">Sedang Diaudit</option>
                        <option value="closed">Sudah Closing</option>
                    </select>
                </div>
                <div id="add-trial-balance-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3">
                    <button type="submit" id="add-trial-balance-submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- BARU: ADD/EDIT AGENDA AUDIT MODAL -->
    <div id="add-edit-agenda-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 id="agenda-modal-title" class="text-lg font-bold text-slate-800">Tambah Agenda Baru</h3>
                <button onclick="closeAddEditAgendaModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="add-edit-agenda-form" class="p-6 space-y-4 overflow-y-auto">
                <input type="hidden" id="agenda-id" name="agendaId">
                <div>
                    <label for="agenda-date" class="block text-sm font-medium text-slate-700 mb-1">Tanggal Kunjungan <span class="text-red-500">*</span></label>
                    <input type="date" id="agenda-date" name="date" class="form-input" required>
                </div>
                <div>
                    <label for="agenda-hotel-select" class="block text-sm font-medium text-slate-700 mb-1">Hotel <span class="text-red-500">*</span></label>
                    <select id="agenda-hotel-select" name="hotelId" class="form-input" required>
                        <option value="">-- Pilih Hotel --</option>
                        <!-- Opsi hotel akan diisi oleh JavaScript -->
                    </select>
                </div>
                <div>
                    <label for="agenda-auditor" class="block text-sm font-medium text-slate-700 mb-1">Auditor <span class="text-red-500">*</span></label>
                    <input type="text" id="agenda-auditor" name="auditor" class="form-input" placeholder="Nama Auditor" required>
                </div>
                <div>
                    <label for="agenda-status" class="block text-sm font-medium text-slate-700 mb-1">Status <span class="text-red-500">*</span></label>
                    <select id="agenda-status" name="status" class="form-input" required><option value="planned">Planned</option><option value="on_progress">On Progress</option><option value="completed">Completed</option><option value="cancelled">Cancelled</option></select>
                </div>
                <div><label for="agenda-notes" class="block text-sm font-medium text-slate-700 mb-1">Keterangan</label><textarea id="agenda-notes" name="notes" class="form-input" rows="3" placeholder="Catatan tambahan..."></textarea></div>
                <div id="add-edit-agenda-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3"><button type="submit" id="add-edit-agenda-submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan</button></div>
            </form>
        </div>
    </div>

    <!-- BARU: MODAL CHECKLIST AUDIT -->
    <div id="audit-checklist-modal" class="fixed inset-0 z-[60] bg-black/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-4xl w-full bg-white rounded-xl shadow-2xl relative flex flex-col max-h-[90vh]">
            <!-- Header -->
            <div class="flex justify-between items-center p-5 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Checklist Audit: <span id="checklist-modal-hotel-name" class="text-blue-600"></span></h3>
                <button onclick="closeAuditChecklistModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="audit-checklist-form" class="flex-1 flex flex-col overflow-hidden">
                <input type="hidden" id="checklist-agenda-id">
                <!-- Body -->
                <div id="audit-checklist-modal-content" class="p-6 space-y-6 overflow-y-auto flex-1">
                    <!-- Konten checklist akan diisi oleh JavaScript -->
                    <div class="text-center p-8">
                        <i class="fa-solid fa-circle-notch fa-spin text-2xl text-blue-500"></i>
                        <p class="mt-2 text-slate-500">Memuat checklist...</p>
                    </div>
                </div>
                <!-- Footer -->
                <div class="p-4 bg-slate-50 border-t border-slate-200 flex justify-end">
                    <button type="button" id="save-audit-checklist-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded-lg transition">
                        Simpan & Selesaikan Audit
                    </button>
                </div>
            </form>
        </div>
    </div>

 <!-- BARU: MODAL KATEGORI CHECKLIST AUDIT -->
    <div id="audit-category-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-md w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 id="audit-category-modal-title" class="text-lg font-bold text-slate-800">Tambah Kategori Baru</h3>
                <button onclick="closeAuditCategoryModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="audit-category-form" class="p-6 space-y-4">
                <input type="hidden" id="audit-category-id" name="categoryId">
                <div>
                    <label for="audit-category-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Kategori <span class="text-red-500">*</span></label>
                    <input type="text" id="audit-category-name" name="name" class="form-input" placeholder="Contoh: Kebersihan Kamar" required>
                </div>
                <div id="audit-category-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3">
                    <button type="submit" id="audit-category-submit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Kategori</button>
                </div>
            </form>
        </div>
    </div>

    <!-- BARU: MODAL ITEM CHECKLIST AUDIT -->
    <div id="audit-item-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col max-h-[90vh]">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 id="audit-item-modal-title" class="text-lg font-bold text-slate-800">Tambah Item Baru</h3>
                <button onclick="closeAuditItemModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="audit-item-form" class="p-6 space-y-4 overflow-y-auto">
                <input type="hidden" id="audit-item-id" name="itemId">
                <input type="hidden" id="audit-item-category-id" name="category_id">
                <div>
                    <label for="audit-item-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Item <span class="text-red-500">*</span></label>
                    <input type="text" id="audit-item-name" name="name" class="form-input" placeholder="Contoh: Lantai bersih dan tidak berdebu" required>
                </div>
                <div>
                    <label for="audit-item-standard" class="block text-sm font-medium text-slate-700 mb-1">Standar Penilaian (Opsional)</label>
                    <textarea id="audit-item-standard" name="standard" class="form-input" rows="3" placeholder="Jelaskan standar kelulusan untuk item ini..."></textarea>
                </div>
                <div class="flex items-center"><input type="checkbox" id="audit-item-is-active" name="is_active" class="form-checkbox h-4 w-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500" checked><label for="audit-item-is-active" class="ml-2 block text-sm text-slate-900">Aktif (item akan muncul di checklist)</label></div>
                <div id="audit-item-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3"><button type="submit" id="audit-item-submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Item</button></div>
            </form>
        </div>
    </div>

    <!-- EDIT OPENING BALANCE MODAL -->
    <div id="edit-opening-balance-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Edit Opening Balance</h3>
                <button onclick="closeEditOpeningBalanceModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="edit-opening-balance-form" class="p-6 space-y-4 overflow-y-auto">
                <input type="hidden" id="edit-ob-hotel-id" name="hotelId">
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-1">Nama Hotel</label>
                    <input type="text" id="edit-ob-hotel-name" class="form-input bg-slate-100 cursor-not-allowed" readonly>
                </div>
                <div>
                    <label for="edit-ob-date" class="block text-sm font-medium text-slate-700 mb-1">Tanggal Efektif Saldo Awal</label>
                    <input type="date" id="edit-ob-date" name="effective_date" class="form-input" required>
                </div>
                <div>
                    <label for="edit-ob-balance" class="block text-sm font-medium text-slate-700 mb-1">Nilai Saldo Awal</label>
                    <input type="number" id="edit-ob-balance" name="balance_value" class="form-input" placeholder="Masukkan nilai saldo awal" required>
                </div>
                <div class="pt-4 flex justify-end gap-3"><button type="submit" id="edit-ob-submit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Perubahan</button></div>
            </form>
        </div>
    </div>

    <!-- ======================================================= -->
    <!-- ============ MODAL PROFIL PENGGUNA (BARU) ============= -->
    <!-- ======================================================= -->
    <div id="profile-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md transform transition-all" onclick="event.stopPropagation()">
            <!-- Modal Header -->
            <div class="flex items-center justify-between p-4 border-b">
                <h3 class="text-lg font-semibold text-slate-800">Profil Pengguna</h3>
                <button onclick="closeProfileModal()" class="text-slate-400 hover:text-slate-600">
                    <i class="fa-solid fa-times fa-lg"></i>
                </button>
            </div>
    
            <!-- Modal Body -->
            <div class="p-6 space-y-6">
                <!-- Info Pengguna -->
                <div>
                    <h4 class="font-semibold text-slate-700" id="profile-modal-name">Nama Pengguna</h4>
                    <p class="text-sm text-slate-500" id="profile-modal-email">email@pengguna.com</p>
                    <p class="text-sm text-slate-500 mt-1">Peran: <span class="font-medium text-blue-600 capitalize" id="profile-modal-role"></span></p>
                </div>
    
                <!-- Daftar Hotel (Khusus Staff) -->
                <div id="profile-hotel-access-section" class="hidden">
                    <h5 class="font-semibold text-slate-600 text-sm mb-2">Hak Akses Hotel:</h5>
                    <ul id="profile-hotel-list" class="space-y-1 text-sm text-slate-600 max-h-24 overflow-y-auto bg-slate-50 p-2 rounded-md">
                        <!-- Daftar hotel akan diisi oleh JavaScript -->
                    </ul>
                </div>
    
                <!-- Form Ganti Password -->
                <div>
                    <h5 class="font-semibold text-slate-600 text-sm mb-3 border-t pt-4">Ganti Password</h5>
                    <form id="change-password-form" class="space-y-4">
                        <div>
                            <label for="current-password" class="block text-sm font-medium text-slate-700">Password Saat Ini</label>
                            <input type="password" id="current-password" name="current_password" required class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="new-password" class="block text-sm font-medium text-slate-700">Password Baru</label>
                            <input type="password" id="new-password" name="new_password" required class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        </div>
                        <div>
                            <label for="confirm-password" class="block text-sm font-medium text-slate-700">Konfirmasi Password Baru</label>
                            <input type="password" id="confirm-password" name="confirm_password" required class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        </div>
                        <div id="change-password-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                        <div class="flex justify-end"><button type="submit" id="change-password-submit-btn" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"><i class="fa-solid fa-key mr-2"></i> Ubah Password</button></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- BARU: MODAL TAMBAH TIPE INSPEKSI -->
    <div id="add-inspection-type-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-md w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Tambah Tipe Inspeksi Baru</h3>
                <button onclick="closeAddInspectionTypeModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="add-inspection-type-form" class="p-6 space-y-4">
                <div>
                    <label for="inspection-type-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Tipe Inspeksi <span class="text-red-500">*</span></label>
                    <input type="text" id="inspection-type-name" name="name" class="form-input" placeholder="Contoh: Inspeksi Kamar" required>
                </div>
                <div id="add-inspection-type-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3">
                    <button type="submit" id="add-inspection-type-submit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Tipe</button>
                </div>
            </form>
        </div>
    </div>

    <!-- BARU: MODAL TAMBAH ITEM INSPEKSI -->
    <div id="add-inspection-item-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Tambah Item Checklist Baru</h3>
                <button onclick="closeAddInspectionItemModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="add-inspection-item-form" class="p-6 space-y-4">
                <input type="hidden" id="item-inspection-type-id" name="inspection_type_id">
                <div>
                    <label for="item-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Item <span class="text-red-500">*</span></label>
                    <input type="text" id="item-name" name="name" class="form-input" placeholder="Contoh: Kebersihan lantai" required>
                </div>
                <div>
                    <label for="item-category" class="block text-sm font-medium text-slate-700 mb-1">Kategori (Opsional)</label>
                    <input type="text" id="item-category" name="category" class="form-input" placeholder="Contoh: Kebersihan, Fasilitas">
                </div>
                <div>
                    <label for="item-standard" class="block text-sm font-medium text-slate-700 mb-1">Standar (Opsional)</label>
                    <textarea id="item-standard" name="standard" class="form-input" rows="3" placeholder="Jelaskan standar kelulusan untuk item ini..."></textarea>
                </div>
                <div id="add-inspection-item-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3"><button type="submit" id="add-inspection-item-submit-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Item</button></div>
            </form>
        </div>
    </div>

    <!-- BARU: MODAL EDIT ITEM INSPEKSI -->
    <div id="edit-inspection-item-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Edit Item Checklist</h3>
                <button onclick="closeEditInspectionItemModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="edit-inspection-item-form" class="p-6 space-y-4">
                <input type="hidden" id="edit-item-id" name="itemId">
                <div>
                    <label for="edit-item-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Item <span class="text-red-500">*</span></label>
                    <input type="text" id="edit-item-name" name="name" class="form-input" required>
                </div>
                <div>
                    <label for="edit-item-category" class="block text-sm font-medium text-slate-700 mb-1">Kategori (Opsional)</label>
                    <input type="text" id="edit-item-category" name="category" class="form-input" placeholder="Contoh: Kebersihan, Fasilitas">
                </div>
                <div>
                    <label for="edit-item-standard" class="block text-sm font-medium text-slate-700 mb-1">Standar (Opsional)</label>
                    <textarea id="edit-item-standard" name="standard" class="form-input" rows="3" placeholder="Jelaskan standar kelulusan untuk item ini..."></textarea>
                </div>
                <div id="edit-inspection-item-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3"><button type="submit" id="edit-inspection-item-submit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Perubahan</button></div>
            </form>
        </div>
    </div>

    <!-- BARU: MODAL TAMBAH PERAN (ROLE) -->
    <div id="add-role-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-lg w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col">
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Tambah Peran Baru</h3>
                <button onclick="closeAddRoleModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <form id="add-role-form" class="p-6 space-y-4">
                <div>
                    <label for="role-name" class="block text-sm font-medium text-slate-700 mb-1">Nama Peran <span class="text-red-500">*</span></label>
                    <input type="text" id="role-name" name="name" class="form-input" placeholder="Contoh: Auditor, Supervisor" required>
                </div>
                <div>
                    <label for="role-description" class="block text-sm font-medium text-slate-700 mb-1">Deskripsi (Opsional)</label>
                    <textarea id="role-description" name="description" class="form-input" rows="3" placeholder="Jelaskan secara singkat fungsi peran ini..."></textarea>
                </div>
                <div id="add-role-error" class="hidden text-sm text-red-600 bg-red-50 p-3 rounded-md"></div>
                <div class="pt-4 flex justify-end gap-3">
                    <button type="submit" id="add-role-submit-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Peran</button>
                </div>
            </form>
        </div>
    </div>

    <!-- BARU: MODAL UNTUK MENGATUR HAK AKSES (PERMISSIONS) -->
    <div id="permissions-modal" class="fixed inset-0 z-50 bg-slate-900/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-4xl w-full bg-white rounded-xl shadow-2xl border border-slate-200 relative fade-in flex flex-col max-h-[90vh]">
            <!-- Header -->
            <div class="flex justify-between items-center p-6 border-b border-slate-200">
                <div>
                    <h3 class="text-lg font-bold text-slate-800">Atur Hak Akses untuk Peran: <span id="permissions-modal-role-name" class="text-blue-600"></span></h3>
                    <p class="text-sm text-slate-500">Pilih hak akses yang diizinkan untuk peran ini.</p>
                </div>
                <button onclick="closePermissionsModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <!-- Body (Scrollable) -->
            <div id="permissions-modal-body" class="p-6 space-y-6 overflow-y-auto">
                <!-- Konten hak akses akan di-generate oleh JavaScript di sini -->
                <div class="text-center p-8"><i class="fa-solid fa-circle-notch fa-spin text-2xl text-blue-500"></i><p class="mt-2 text-slate-500">Memuat hak akses...</p></div>
            </div>
            <!-- Footer -->
            <div class="p-6 bg-slate-50 border-t border-slate-200 flex justify-end gap-3">
                <button onclick="closePermissionsModal()" class="bg-slate-200 hover:bg-slate-300 text-slate-700 font-bold py-2 px-4 rounded-lg transition">Batal</button>
                <button id="save-permissions-from-modal-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">Simpan Perubahan</button>
            </div>
        </div>
    </div>

    <!-- BARU: MODAL UNTUK MELIHAT FOTO INSPEKSI -->
    <div id="photo-viewer-modal" class="fixed inset-0 z-[60] bg-black/80 hidden items-center justify-center backdrop-blur-sm p-4" onclick="closePhotoModal()">
        <div class="max-w-3xl max-h-[90vh] w-full bg-white rounded-lg shadow-2xl relative flex flex-col" onclick="event.stopPropagation()">
            <!-- Header -->
            <div class="flex justify-between items-center p-4 border-b">
                <h3 class="text-lg font-semibold text-slate-800">Lihat Foto</h3>
                <button onclick="closePhotoModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition">
                    <i class="fa-solid fa-xmark text-slate-600"></i>
                </button>
            </div>
            <!-- Image Container -->
            <div class="p-4 flex-grow flex items-center justify-center overflow-hidden">
                <img id="photo-viewer-img" src="" alt="Foto Inspeksi" class="max-w-full max-h-full object-contain">
            </div>
        </div>
    </div>

    <!-- BARU: MODAL DETAIL TUGAS -->
    <div id="task-detail-modal" class="fixed inset-0 z-[60] bg-black/70 hidden items-center justify-center backdrop-blur-sm p-4">
        <div class="max-w-2xl w-full bg-white rounded-xl shadow-2xl relative flex flex-col max-h-[90vh]">
            <!-- Header -->
            <div class="flex justify-between items-center p-5 border-b border-slate-200">
                <h3 class="text-lg font-bold text-slate-800">Detail Tugas</h3>
                <button onclick="closeTaskDetailModal()" class="w-8 h-8 bg-slate-100 hover:bg-slate-200 rounded-full flex items-center justify-center transition"><i class="fa-solid fa-xmark text-slate-600"></i></button>
            </div>
            <!-- Body -->
            <div id="task-detail-content" class="p-6 space-y-4 overflow-y-auto">
                <!-- Konten detail akan diisi oleh JavaScript -->
                <div class="text-center p-8">
                    <i class="fa-solid fa-circle-notch fa-spin text-2xl text-blue-500"></i>
                    <p class="mt-2 text-slate-500">Memuat detail tugas...</p>
                </div>
            </div>
            <!-- BARU: Bagian Upload Foto Selesai (awalnya tersembunyi) -->
            <div id="task-completion-photo-section" class="hidden p-6 pt-0 space-y-2">
                <label class="block text-sm font-medium text-slate-700">Upload Foto Bukti Selesai (Opsional)</label>
                <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-slate-300 border-dashed rounded-md">
                    <div class="space-y-1 text-center">
                        <i class="mx-auto h-12 w-12 text-slate-400 fa-solid fa-camera"></i>
                        <div class="flex text-sm text-slate-600"><label for="task-completion-photo-input" class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500"><span>Upload file</span><input id="task-completion-photo-input" name="completion_photo" type="file" class="sr-only" accept="image/*" capture="environment"></label><p class="pl-1">atau drag and drop</p></div>
                        <p id="task-completion-photo-filename" class="text-xs text-slate-500">PNG, JPG, GIF up to 10MB</p>
                    </div>
                </div>
            </div>
            <!-- Footer -->
            <div class="p-4 bg-slate-50 border-t border-slate-200 space-y-3">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <div>
                        <label for="task-detail-due-date" class="text-xs font-medium text-slate-600">Batas Waktu</label>
                        <input type="date" id="task-detail-due-date" class="form-input text-sm w-full mt-1">
                    </div>
                    <div>
                        <label for="task-detail-assigned-to" class="text-xs font-medium text-slate-600">Ditugaskan kepada</label>
                        <select id="task-detail-assigned-to" class="form-input text-sm w-full mt-1"></select>
                    </div>
                    <div>
                        <label for="task-detail-status-select" class="text-xs font-medium text-slate-600">Status Tugas</label>
                        <select id="task-detail-status-select" class="form-input text-sm w-full mt-1"><option value="pending">Pending</option><option value="in_progress">In Progress</option><option value="completed">Completed</option><option value="cancelled">Cancelled</option></select>
                    </div>
                </div>
                <button id="task-detail-update-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">
                    Update Status
                </button>
            </div>
        </div>
    </div>






    <script>
        function toggleSubmenu(submenuId) {
            const submenu = document.getElementById(submenuId);
            const arrow = document.getElementById(`${submenuId}-arrow`);
            if (submenu) {
                submenu.classList.toggle('hidden');
            }
            if (arrow) {
                arrow.classList.toggle('rotate-180');
            }
        }
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            const dateElement = document.getElementById('current-date');
            if (dateElement) {
                const today = new Date();
                const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
                dateElement.textContent = today.toLocaleDateString('id-ID', options);
            }
        });
    </script>
    <!-- Custom JS (Urutan penting: utils harus dimuat lebih dulu) -->
    <script src="js/utils.js?v=1"></script>
    <script src="js/auth.js?v=1"></script>
    <script src="js/ui.js?v=1"></script>
    <script src="js/dashboard.js?v=1"></script>
    <script src="js/daily-income.js?v=1"></script>
    <script src="js/reports.js?v=1"></script>
    <script src="js/settings.js?v=1"></script>
    <script src="js/slides.js?v=1"></script>
    <script src="js/dsr.js?v=1"></script>
    <script src="js/ebook.js?v=1"></script>
    <!-- Common P&L functions must be loaded before specific P&L modules -->
    <script src="js/input-pl-common.js?v=1"></script>
    <script src="js/input-budget-pl.js?v=1"></script>
    <script src="js/input-actual-pl.js?v=1"></script>
    <script src="js/input-room-production.js?v=1"></script>
    <script src="js/input-ar-aging.js?v=1"></script>
    <script src="js/input-hotel-competitor.js?v=1"></script>
    <script src="js/guest-review-dashboard.js"></script>
    <script src="js/guest-review-replies.js"></script>    
    <!-- BARU: Script untuk fitur Inspection -->
    <script src="js/guest-review-vouchers.js"></script>
    <script src="js/guest-review-settings.js"></script>
    <script src="js/inspection.js"></script>
    <script src="js/audit-checklist.js"></script> <!-- BARU -->
    <script src="js/audit.js"></script>
    <script src="js/audit-calendar.js"></script> <!-- BARU -->
    <script src="js/trial-balance.js"></script>
    <script src="js/competitor-settings.js"></script> <!-- BARU -->
    <script src="js/script.js"></script>
</body>
</html>